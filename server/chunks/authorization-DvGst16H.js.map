{"version":3,"file":"authorization-DvGst16H.js","sources":["../../../.svelte-kit/adapter-node/chunks/authorization.js"],"sourcesContent":["import { e as error } from \"./index.js\";\nimport { p as errors_missingPermissions } from \"./messages.js\";\nconst isAuthorized = (apiName, user) => {\n  if (user?.policies.includes(apiName)) return true;\n  return false;\n};\nconst authorize = (apiName, user) => {\n  const apiNames = Array.isArray(apiName) ? apiName : [apiName];\n  for (const name of apiNames) {\n    if (!isAuthorized(name, user)) {\n      throw error(403, `${errors_missingPermissions()} ${name}`);\n    }\n  }\n};\nconst getDerivedRoles = (groupList, signedIn = false, classYear = void 0) => {\n  const splitGroups = /* @__PURE__ */ new Set();\n  groupList?.forEach(\n    (group) => group.split(\".\").forEach((_, i, arr) => splitGroups.add(arr.slice(0, i + 1).join(\".\")))\n  );\n  splitGroups.add(\"*\");\n  if (groupList?.length || signedIn) splitGroups.add(\"_\");\n  if (classYear && classYear === (/* @__PURE__ */ new Date()).getFullYear())\n    splitGroups.add(\"nolla\");\n  return [...splitGroups];\n};\nexport {\n  authorize as a,\n  getDerivedRoles as g,\n  isAuthorized as i\n};\n"],"names":[],"mappings":";;;AAEK,MAAC,YAAY,GAAG,CAAC,OAAO,EAAE,IAAI,KAAK;AACxC,EAAE,IAAI,IAAI,EAAE,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO,IAAI,CAAC;AACpD,EAAE,OAAO,KAAK,CAAC;AACf,EAAE;AACG,MAAC,SAAS,GAAG,CAAC,OAAO,EAAE,IAAI,KAAK;AACrC,EAAE,MAAM,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,OAAO,GAAG,CAAC,OAAO,CAAC,CAAC;AAChE,EAAE,KAAK,MAAM,IAAI,IAAI,QAAQ,EAAE;AAC/B,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE;AACnC,MAAM,MAAM,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,yBAAyB,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AACjE,KAAK;AACL,GAAG;AACH,EAAE;AACG,MAAC,eAAe,GAAG,CAAC,SAAS,EAAE,QAAQ,GAAG,KAAK,EAAE,SAAS,GAAG,KAAK,CAAC,KAAK;AAC7E,EAAE,MAAM,WAAW,mBAAmB,IAAI,GAAG,EAAE,CAAC;AAChD,EAAE,SAAS,EAAE,OAAO;AACpB,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACtG,GAAG,CAAC;AACJ,EAAE,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACvB,EAAE,IAAI,SAAS,EAAE,MAAM,IAAI,QAAQ,EAAE,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAC1D,EAAE,IAAI,SAAS,IAAI,SAAS,KAAK,iBAAiB,IAAI,IAAI,EAAE,EAAE,WAAW,EAAE;AAC3E,IAAI,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AAC7B,EAAE,OAAO,CAAC,GAAG,WAAW,CAAC,CAAC;AAC1B;;;;"}