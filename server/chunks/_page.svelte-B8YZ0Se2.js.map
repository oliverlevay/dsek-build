{"version":3,"file":"_page.svelte-B8YZ0Se2.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(app)/documents/requirements/_page.svelte.js"],"sourcesContent":["import { a as subscribe, g as getContext } from \"../../../../../chunks/lifecycle.js\";\nimport { c as create_ssr_component, a as add_attribute, b as escape, e as each, v as validate_component } from \"../../../../../chunks/ssr.js\";\nimport { d as PUBLIC_BUCKETS_DOCUMENTS } from \"../../../../../chunks/public.js\";\nimport { P as Pagination } from \"../../../../../chunks/Pagination.js\";\nimport { S as SetPageTitle } from \"../../../../../chunks/SetPageTitle.js\";\nimport { a as apiNames } from \"../../../../../chunks/apiNames.js\";\nimport { i as isAuthorized } from \"../../../../../chunks/authorization.js\";\nimport { G as documents_requirementProfiles, d6 as documents_filterByYear, b_ as documents_uploadFile, d8 as documents_edit } from \"../../../../../chunks/messages.js\";\nimport { D as DeleteFileForm } from \"../../../../../chunks/DeleteFileForm.js\";\nimport { F as FileLink } from \"../../../../../chunks/FileLink.js\";\nimport { p as page } from \"../../../../../chunks/stores.js\";\nfunction foldersFirstAlphabetically(a, b) {\n  if (a.isFolder && !b.isFolder) {\n    return -1;\n  }\n  if (b.isFolder && !a.isFolder) {\n    return 1;\n  }\n  return a.name.localeCompare(b.name, \"sv\");\n}\nconst Folder = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let foldericon;\n  let $page, $$unsubscribe_page;\n  $$unsubscribe_page = subscribe(page, (value) => $page = value);\n  let { expanded = true } = $$props;\n  let { name } = $$props;\n  let { folders } = $$props;\n  let { isEditing = false } = $$props;\n  let { deleteForm } = $$props;\n  if ($$props.expanded === void 0 && $$bindings.expanded && expanded !== void 0) $$bindings.expanded(expanded);\n  if ($$props.name === void 0 && $$bindings.name && name !== void 0) $$bindings.name(name);\n  if ($$props.folders === void 0 && $$bindings.folders && folders !== void 0) $$bindings.folders(folders);\n  if ($$props.isEditing === void 0 && $$bindings.isEditing && isEditing !== void 0) $$bindings.isEditing(isEditing);\n  if ($$props.deleteForm === void 0 && $$bindings.deleteForm && deleteForm !== void 0) $$bindings.deleteForm(deleteForm);\n  {\n    folders.sort(foldersFirstAlphabetically);\n  }\n  foldericon = expanded ? \"i-mdi-folder-open-outline\" : \"i-mdi-folder-outline\";\n  $$unsubscribe_page();\n  return `<div class=\"flex\"${add_attribute(\"data-tip\", name, 0)}><button><span${add_attribute(\"class\", foldericon + \" align-text-top text-xl text-primary\", 0)}></span> ${escape(name)}</button></div> <div class=\"m-2 border-l border-gray-400 pl-5\">${expanded ? `${each(folders, (folder) => {\n    return `${folder.isFolder ? `${validate_component(Folder, \"svelte:self\").$$render(\n      $$result,\n      {\n        name: folder.name,\n        folders: folder.files,\n        expanded: false,\n        isEditing,\n        deleteForm\n      },\n      {},\n      {}\n    )}` : `<div class=\"flex flex-row gap-1\">${validate_component(FileLink, \"FileLink\").$$render($$result, { name: folder.name, url: folder.url }, {}, {})} ${isAuthorized(apiNames.FILES.BUCKET(PUBLIC_BUCKETS_DOCUMENTS).DELETE, $page.data.user) && isEditing ? `${validate_component(DeleteFileForm, \"DeleteFileForm\").$$render(\n      $$result,\n      {\n        fileId: folder.id,\n        fileName: folder.name,\n        data: deleteForm\n      },\n      {},\n      {}\n    )}` : ``} </div>`}`;\n  })}` : ``}</div>`;\n});\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let canCreate;\n  let canDelete;\n  let { data } = $$props;\n  let isEditing = false;\n  const currentYear = /* @__PURE__ */ (/* @__PURE__ */ new Date()).getFullYear();\n  const folders = [];\n  function processFolder(folder, pathSoFar, array) {\n    if (pathSoFar.startsWith(\"/\")) pathSoFar = pathSoFar.substring(1);\n    const name = folder.split(\"/\")[0];\n    if (folder) {\n      const exists = array?.find((f) => f.name === name);\n      let newArray;\n      if (exists) {\n        newArray = exists.files;\n      } else {\n        array.push({\n          id: \"\",\n          url: \"\",\n          name: name ? name : \"undefined\",\n          isFolder: true,\n          files: []\n        });\n        newArray = array[array?.length - 1].files;\n      }\n      processFolder(folder.split(\"/\").slice(1).join(\"/\"), pathSoFar + \"/\" + name, newArray);\n    } else {\n      data.folders[pathSoFar]?.forEach((file) => {\n        array.push({\n          id: file.id,\n          name: file.name,\n          isFolder: false,\n          url: file.thumbnailUrl ? file.thumbnailUrl : \"\",\n          files: []\n        });\n      });\n    }\n  }\n  const pArAgLiDe_translate_attribute_pass_context = getContext(\"$paraglide-adapter-sveltekit:context\");\n  function pArAgLiDe_translate_attribute_pass_translateAttribute(value, lang_value) {\n    if (!pArAgLiDe_translate_attribute_pass_context) return value;\n    return pArAgLiDe_translate_attribute_pass_context.translateHref(value, lang_value);\n  }\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);\n  {\n    {\n      folders.length = 0;\n      Object.keys(data[\"folders\"]).forEach((folder) => {\n        processFolder(folder, \"\", folders);\n      });\n    }\n  }\n  canCreate = isAuthorized(apiNames.FILES.BUCKET(PUBLIC_BUCKETS_DOCUMENTS).CREATE, data.user);\n  canDelete = isAuthorized(apiNames.FILES.BUCKET(PUBLIC_BUCKETS_DOCUMENTS).DELETE, data.user);\n  return `${validate_component(SetPageTitle, \"SetPageTitle\").$$render($$result, { title: documents_requirementProfiles() }, {}, {})} <div class=\"mb-4 flex w-full flex-col items-start gap-2\"><span class=\"text-lg\">${escape(documents_filterByYear())}</span> ${validate_component(Pagination, \"Pagination\").$$render(\n    $$result,\n    {\n      class: \"max-w-prose\",\n      count: currentYear - 1981,\n      getPageName: (pageNumber) => (currentYear - pageNumber).toString(),\n      getPageNumber: (pageName) => currentYear - +pageName,\n      fieldName: \"year\"\n    },\n    {},\n    {}\n  )}</div> ${canCreate || canDelete ? `<div class=\"mb-4 flex flex-row gap-1\">${canCreate ? `<a class=\"btn btn-primary btn-sm\"${add_attribute(\"href\", pArAgLiDe_translate_attribute_pass_translateAttribute(`/documents/upload?type=requirement`, void 0), 0)}>${escape(documents_uploadFile())}</a>` : ``} ${canDelete ? `<button class=\"btn btn-secondary btn-sm\">${escape(documents_edit())}</button>` : ``}</div>` : ``} <div class=\"flex flex-col rounded-lg bg-base-200 p-5\">${validate_component(Folder, \"Folder\").$$render(\n    $$result,\n    {\n      name: \"\",\n      folders,\n      deleteForm: data.deleteForm,\n      isEditing\n    },\n    {},\n    {}\n  )}</div>`;\n});\nexport {\n  Page as default\n};\n"],"names":[],"mappings":"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"}