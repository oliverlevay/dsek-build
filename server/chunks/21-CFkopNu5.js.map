{"version":3,"file":"21-CFkopNu5.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(app)/songbook/_slug_/_layout.server.ts.js","../../../.svelte-kit/adapter-node/nodes/21.js"],"sourcesContent":["import { W as songbook_errors_songNotFound } from \"../../../../../chunks/messages.js\";\nimport { e as error } from \"../../../../../chunks/index.js\";\nimport \"just-clone\";\nimport \"ts-deepmerge\";\nimport \"memoize-weak\";\nimport { z as zod } from \"../../../../../chunks/zod.js\";\nimport \"devalue\";\nimport { s as superValidate } from \"../../../../../chunks/superValidate.js\";\nimport { c as canAccessDeletedSongs, g as getExistingCategories, a as getExistingMelodies, f as fixSongText } from \"../../../../../chunks/helpers.js\";\nimport { u as updateSongSchema } from \"../../../../../chunks/schema.js\";\nconst load = async ({ locals, params }) => {\n  const { prisma, user } = locals;\n  const accessPolicies = user?.policies ?? [];\n  const song = await prisma.song.findUnique({\n    where: {\n      slug: params.slug,\n      deletedAt: canAccessDeletedSongs(accessPolicies) ? {} : null\n    }\n  });\n  if (song == null) {\n    throw error(404, {\n      message: songbook_errors_songNotFound()\n    });\n  }\n  const [existingCategories, existingMelodies] = await Promise.all([\n    getExistingCategories(\n      prisma,\n      accessPolicies,\n      canAccessDeletedSongs(accessPolicies)\n    ),\n    getExistingMelodies(\n      prisma,\n      accessPolicies,\n      canAccessDeletedSongs(accessPolicies)\n    )\n  ]);\n  const form = await superValidate(song, zod(updateSongSchema));\n  return {\n    song: {\n      ...song,\n      title: fixSongText(song.title),\n      lyrics: fixSongText(song.lyrics)\n    },\n    updateForm: form,\n    existingCategories,\n    existingMelodies\n  };\n};\nexport {\n  load\n};\n","import * as server from '../entries/pages/(app)/songbook/_slug_/_layout.server.ts.js';\n\nexport const index = 21;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/fallbacks/layout.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/(app)/songbook/[slug]/+layout.server.ts\";\nexport const imports = [\"_app/immutable/nodes/21.Bv1hflUC.js\",\"_app/immutable/chunks/21.eyQct81Z.js\",\"_app/immutable/chunks/scheduler.DK5noefF.js\",\"_app/immutable/chunks/index.OECaLbXR.js\"];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":";;;;;;;;;;AAUA,MAAM,IAAI,GAAG,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK;AAC3C,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,CAAC;AAClC,EAAE,MAAM,cAAc,GAAG,IAAI,EAAE,QAAQ,IAAI,EAAE,CAAC;AAC9C,EAAE,MAAM,IAAI,GAAG,MAAM,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;AAC5C,IAAI,KAAK,EAAE;AACX,MAAM,IAAI,EAAE,MAAM,CAAC,IAAI;AACvB,MAAM,SAAS,EAAE,qBAAqB,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,IAAI;AAClE,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,IAAI,IAAI,IAAI,EAAE;AACpB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE;AACrB,MAAM,OAAO,EAAE,4BAA4B,EAAE;AAC7C,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,MAAM,CAAC,kBAAkB,EAAE,gBAAgB,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;AACnE,IAAI,qBAAqB;AACzB,MAAM,MAAM;AACZ,MAAM,cAAc;AACpB,MAAM,qBAAqB,CAAC,cAAc,CAAC;AAC3C,KAAK;AACL,IAAI,mBAAmB;AACvB,MAAM,MAAM;AACZ,MAAM,cAAc;AACpB,MAAM,qBAAqB,CAAC,cAAc,CAAC;AAC3C,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,MAAM,IAAI,GAAG,MAAM,aAAa,CAAC,IAAI,EAAE,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC;AAChE,EAAE,OAAO;AACT,IAAI,IAAI,EAAE;AACV,MAAM,GAAG,IAAI;AACb,MAAM,KAAK,EAAE,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC;AACpC,MAAM,MAAM,EAAE,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC;AACtC,KAAK;AACL,IAAI,UAAU,EAAE,IAAI;AACpB,IAAI,kBAAkB;AACtB,IAAI,gBAAgB;AACpB,GAAG,CAAC;AACJ,CAAC;;;;;;;AC7CW,MAAC,KAAK,GAAG,GAAG;AACxB,IAAI,eAAe,CAAC;AACR,MAAC,SAAS,GAAG,YAAY,eAAe,KAAK,CAAC,MAAM,OAAO,6BAAuC,CAAC,EAAE,QAAQ;AAE7G,MAAC,SAAS,GAAG,qDAAqD;AAClE,MAAC,OAAO,GAAG,CAAC,qCAAqC,CAAC,sCAAsC,CAAC,6CAA6C,CAAC,yCAAyC,EAAE;AAClL,MAAC,WAAW,GAAG,GAAG;AAClB,MAAC,KAAK,GAAG;;;;"}