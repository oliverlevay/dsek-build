{"version":3,"file":"_server.ts-BjZywlWU.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/(app)/events/id/_id_/_server.ts.js"],"sourcesContent":["import { a as authorizedPrismaClient } from \"../../../../../../chunks/authorizedPrisma.js\";\nimport { r as redirect, e as eventLink } from \"../../../../../../chunks/redirect.js\";\nimport { s as slugify, a as slugWithCount } from \"../../../../../../chunks/slugify.js\";\nimport { e as error } from \"../../../../../../chunks/index.js\";\nconst GET = async ({ params }) => {\n  const id = params.id;\n  const event = await authorizedPrismaClient.event.findUnique({\n    where: {\n      id\n    }\n  });\n  if (!event) {\n    throw error(404, \"Event not found\");\n  }\n  let eventSlug = event?.slug;\n  if (eventSlug == null) {\n    const slug = slugify(event.title);\n    const slugCount = await authorizedPrismaClient.event.count({\n      where: {\n        slug: {\n          startsWith: slug\n        }\n      }\n    });\n    const newSlug = slugWithCount(slug, slugCount);\n    await authorizedPrismaClient.event.update({\n      where: {\n        id\n      },\n      data: {\n        slug: newSlug\n      }\n    });\n    eventSlug = newSlug;\n  }\n  throw redirect(302, eventLink({ id: event.id, slug: eventSlug }));\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAIK,MAAC,GAAG,GAAG,OAAO,EAAE,MAAM,EAAE,KAAK;AAClC,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC;AACvB,EAAE,MAAM,KAAK,GAAG,MAAM,sBAAsB,CAAC,KAAK,CAAC,UAAU,CAAC;AAC9D,IAAI,KAAK,EAAE;AACX,MAAM,EAAE;AACR,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,CAAC,KAAK,EAAE;AACd,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAC;AACxC,GAAG;AACH,EAAE,IAAI,SAAS,GAAG,KAAK,EAAE,IAAI,CAAC;AAC9B,EAAE,IAAI,SAAS,IAAI,IAAI,EAAE;AACzB,IAAI,MAAM,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACtC,IAAI,MAAM,SAAS,GAAG,MAAM,sBAAsB,CAAC,KAAK,CAAC,KAAK,CAAC;AAC/D,MAAM,KAAK,EAAE;AACb,QAAQ,IAAI,EAAE;AACd,UAAU,UAAU,EAAE,IAAI;AAC1B,SAAS;AACT,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,OAAO,GAAG,aAAa,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACnD,IAAI,MAAM,sBAAsB,CAAC,KAAK,CAAC,MAAM,CAAC;AAC9C,MAAM,KAAK,EAAE;AACb,QAAQ,EAAE;AACV,OAAO;AACP,MAAM,IAAI,EAAE;AACZ,QAAQ,IAAI,EAAE,OAAO;AACrB,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,SAAS,GAAG,OAAO,CAAC;AACxB,GAAG;AACH,EAAE,MAAM,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC,EAAE,EAAE,EAAE,KAAK,CAAC,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;AACpE;;;;"}