{"version":3,"file":"_server.ts-Cj_KrXXZ.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/(app)/api/events/_server.ts.js"],"sourcesContent":["import { e as error } from \"../../../../../chunks/index.js\";\nimport { B as BASIC_EVENT_FILTER } from \"../../../../../chunks/events.js\";\nconst GET = async ({ locals, url }) => {\n  const { prisma } = locals;\n  const search = url.searchParams.get(\"search\")?.toLowerCase();\n  if (search == void 0 || search.length === 0) {\n    throw error(400, \"you need to provide a search value\");\n  }\n  const searchString = search.split(\" \").filter((part) => part.length > 0).join(\" | \");\n  const events = await prisma.event.findMany({\n    where: {\n      AND: [\n        BASIC_EVENT_FILTER(null),\n        {\n          OR: [\n            {\n              title: {\n                contains: search,\n                mode: \"insensitive\"\n              }\n            },\n            {\n              titleEn: {\n                contains: search,\n                mode: \"insensitive\"\n              }\n            },\n            {\n              title: {\n                search: searchString\n              }\n            },\n            {\n              titleEn: {\n                search: searchString\n              }\n            }\n          ]\n        }\n      ]\n    },\n    orderBy: [\n      {\n        _relevance: {\n          fields: [\"title\"],\n          search: searchString,\n          sort: \"desc\"\n        }\n      },\n      {\n        _relevance: {\n          fields: [\"titleEn\"],\n          search: searchString,\n          sort: \"desc\"\n        }\n      },\n      {\n        startDatetime: \"desc\"\n      }\n    ],\n    take: 20\n  });\n  return new Response(JSON.stringify(events));\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;AAEK,MAAC,GAAG,GAAG,OAAO,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK;AACvC,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC;AAC5B,EAAE,MAAM,MAAM,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,WAAW,EAAE,CAAC;AAC/D,EAAE,IAAI,MAAM,IAAI,KAAK,CAAC,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;AAC/C,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,oCAAoC,CAAC,CAAC;AAC3D,GAAG;AACH,EAAE,MAAM,YAAY,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACvF,EAAE,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC;AAC7C,IAAI,KAAK,EAAE;AACX,MAAM,GAAG,EAAE;AACX,QAAQ,kBAAkB,CAAC,IAAI,CAAC;AAChC,QAAQ;AACR,UAAU,EAAE,EAAE;AACd,YAAY;AACZ,cAAc,KAAK,EAAE;AACrB,gBAAgB,QAAQ,EAAE,MAAM;AAChC,gBAAgB,IAAI,EAAE,aAAa;AACnC,eAAe;AACf,aAAa;AACb,YAAY;AACZ,cAAc,OAAO,EAAE;AACvB,gBAAgB,QAAQ,EAAE,MAAM;AAChC,gBAAgB,IAAI,EAAE,aAAa;AACnC,eAAe;AACf,aAAa;AACb,YAAY;AACZ,cAAc,KAAK,EAAE;AACrB,gBAAgB,MAAM,EAAE,YAAY;AACpC,eAAe;AACf,aAAa;AACb,YAAY;AACZ,cAAc,OAAO,EAAE;AACvB,gBAAgB,MAAM,EAAE,YAAY;AACpC,eAAe;AACf,aAAa;AACb,WAAW;AACX,SAAS;AACT,OAAO;AACP,KAAK;AACL,IAAI,OAAO,EAAE;AACb,MAAM;AACN,QAAQ,UAAU,EAAE;AACpB,UAAU,MAAM,EAAE,CAAC,OAAO,CAAC;AAC3B,UAAU,MAAM,EAAE,YAAY;AAC9B,UAAU,IAAI,EAAE,MAAM;AACtB,SAAS;AACT,OAAO;AACP,MAAM;AACN,QAAQ,UAAU,EAAE;AACpB,UAAU,MAAM,EAAE,CAAC,SAAS,CAAC;AAC7B,UAAU,MAAM,EAAE,YAAY;AAC9B,UAAU,IAAI,EAAE,MAAM;AACtB,SAAS;AACT,OAAO;AACP,MAAM;AACN,QAAQ,aAAa,EAAE,MAAM;AAC7B,OAAO;AACP,KAAK;AACL,IAAI,IAAI,EAAE,EAAE;AACZ,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;AAC9C;;;;"}