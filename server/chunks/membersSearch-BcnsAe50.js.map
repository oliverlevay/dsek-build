{"version":3,"file":"membersSearch-BcnsAe50.js","sources":["../../../.svelte-kit/adapter-node/chunks/membersSearch.js"],"sourcesContent":["const searchForMembers = async (prisma, search, filter = {}) => {\n  let [firstName, lastName] = [\n    void 0,\n    void 0\n  ];\n  if (search.split(\" \").length >= 2 && search.split(\" \").every((part) => part.length > 0)) {\n    [firstName, lastName] = search.split(\" \");\n  }\n  const nickname = search.match(/\"(.+)\"/)?.[1];\n  const studentId = search.match(/(\\w{2}\\d{4}\\w{2}-s)/)?.[1];\n  const members = await prisma.member.findMany({\n    where: {\n      OR: [\n        {\n          firstName: firstName || !studentId && !nickname ? {\n            search: firstName ?? search,\n            mode: \"insensitive\"\n          } : void 0\n        },\n        {\n          lastName: lastName || !studentId && !nickname ? {\n            search: lastName ?? search,\n            mode: \"insensitive\"\n          } : void 0\n        },\n        {\n          nickname: nickname ? {\n            search: nickname,\n            mode: \"insensitive\"\n          } : void 0\n        },\n        {\n          studentId: studentId ? {\n            search: studentId,\n            mode: \"insensitive\"\n          } : void 0\n        }\n      ],\n      ...filter\n    },\n    orderBy: [\n      studentId ? {\n        _relevance: {\n          fields: [\"studentId\"],\n          search: studentId,\n          sort: \"desc\"\n        }\n      } : {},\n      {\n        _relevance: {\n          fields: [\"firstName\"],\n          search: search.split(\" \").filter((part) => part.length > 0).join(\" | \"),\n          sort: \"desc\"\n        }\n      },\n      {\n        _relevance: {\n          fields: [\"lastName\"],\n          search: search.split(\" \").filter((part) => part.length > 0).join(\" | \"),\n          sort: \"desc\"\n        }\n      },\n      {\n        classYear: \"desc\"\n      }\n    ],\n    take: 20\n  });\n  return members;\n};\nexport {\n  searchForMembers as s\n};\n"],"names":[],"mappings":"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"}