{"version":3,"file":"EntitySearch-D4ZWMg82.js","sources":["../../../.svelte-kit/adapter-node/chunks/EntitySearch.js"],"sourcesContent":["import { a as subscribe } from \"./lifecycle.js\";\nimport { c as create_ssr_component, a as add_attribute, e as each } from \"./ssr.js\";\nimport { p as page } from \"./stores.js\";\nimport { twMerge } from \"tailwind-merge\";\nconst EntitySearch = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let $page, $$unsubscribe_page;\n  $$unsubscribe_page = subscribe(page, (value) => $page = value);\n  let { class: clazz = \"\" } = $$props;\n  let { endpoint } = $$props;\n  let { isSearching = false } = $$props;\n  let { onSelect = void 0 } = $$props;\n  const handleSearch = (searchValue) => {\n    if (timeout) clearTimeout(timeout);\n    if (searchValue.length < 3) {\n      reset();\n      return;\n    }\n    isSearching = true;\n    timeout = setTimeout(getEntities(searchValue), 300);\n  };\n  let { year = void 0 } = $$props;\n  let timeout = void 0;\n  let searchResults = null;\n  const getEntities = (searchValue) => async () => {\n    if (!searchValue) {\n      reset();\n      return;\n    }\n    const url = new URL($page.url.origin + endpoint);\n    url.searchParams.append(\"search\", searchValue);\n    if (year) {\n      url.searchParams.append(\"year\", year.toString());\n    }\n    const data = await fetch(url, { method: \"GET\" }).then((res) => {\n      if (!res.ok) {\n        handleError();\n        return;\n      }\n      return res.json();\n    }).catch(() => handleError());\n    searchResults = data || [];\n    isSearching = false;\n  };\n  const handleError = () => {\n    console.error(\"Failed to fetch entities\");\n    reset();\n  };\n  const reset = () => {\n    searchResults = null;\n    isSearching = false;\n  };\n  if ($$props.class === void 0 && $$bindings.class && clazz !== void 0) $$bindings.class(clazz);\n  if ($$props.endpoint === void 0 && $$bindings.endpoint && endpoint !== void 0) $$bindings.endpoint(endpoint);\n  if ($$props.isSearching === void 0 && $$bindings.isSearching && isSearching !== void 0) $$bindings.isSearching(isSearching);\n  if ($$props.onSelect === void 0 && $$bindings.onSelect && onSelect !== void 0) $$bindings.onSelect(onSelect);\n  if ($$props.handleSearch === void 0 && $$bindings.handleSearch && handleSearch !== void 0) $$bindings.handleSearch(handleSearch);\n  if ($$props.year === void 0 && $$bindings.year && year !== void 0) $$bindings.year(year);\n  $$unsubscribe_page();\n  return `<div${add_attribute(\"class\", twMerge(\"dropdown overflow-visible\", clazz), 0)}>${slots.default ? slots.default({}) : ``} <ul class=\"menu-compact menu dropdown-content join join-vertical z-10 flex max-h-80 min-w-[20rem] flex-col flex-nowrap overflow-visible overflow-y-auto rounded-md bg-base-100 p-0 shadow shadow-black\">${searchResults != null ? `${each(searchResults, (option) => {\n    return `<li><button type=\"button\" class=\"join-item w-full border-b border-b-base-content/10\">${slots.entity ? slots.entity({ option }) : ``}</button> </li>`;\n  })} ${searchResults.length === 0 ? `<li class=\"w-full border-b border-b-base-content/10\" data-svelte-h=\"svelte-lherye\"><button type=\"button\" disabled class=\"disabled\">Inga resultat hittades</button></li>` : ``}` : ``}</ul></div>`;\n});\nexport {\n  EntitySearch as E\n};\n"],"names":[],"mappings":"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"}