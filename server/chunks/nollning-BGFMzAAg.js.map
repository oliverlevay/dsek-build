{"version":3,"file":"nollning-BGFMzAAg.js","sources":["../../../.svelte-kit/adapter-node/chunks/nollning.js"],"sourcesContent":["import { a as authorizedPrismaClient } from \"./authorizedPrisma.js\";\nconst NOLLNING_START_KEY = \"nollning_start\";\nconst NOLLNING_END_KEY = \"nollning_end\";\nlet cache = null;\nconst CACHE_TIME = 3600 * 1e3;\nconst isNollningPeriod = async () => {\n  const now = /* @__PURE__ */ new Date();\n  if (cache !== null && cache.lastFetched.valueOf() + CACHE_TIME > now.valueOf())\n    return cache.value;\n  const rows = await authorizedPrismaClient.adminSetting.findMany({\n    where: {\n      OR: [\n        {\n          key: NOLLNING_START_KEY\n        },\n        {\n          key: NOLLNING_END_KEY\n        }\n      ]\n    }\n  });\n  const startStr = rows.find((row) => row.key === NOLLNING_START_KEY)?.value;\n  const endStr = rows.find((row) => row.key === NOLLNING_END_KEY)?.value;\n  if (!startStr || !endStr) return false;\n  const start = new Date(startStr);\n  const end = new Date(endStr);\n  const isNollningPeriod2 = start < now && now < end;\n  cache = {\n    value: isNollningPeriod2,\n    lastFetched: now\n  };\n  return isNollningPeriod2;\n};\nconst updateNollningPeriod = async (prisma, start, end) => {\n  await prisma.adminSetting.upsert({\n    where: {\n      key: NOLLNING_START_KEY\n    },\n    update: {\n      value: start.toISOString()\n    },\n    create: {\n      key: NOLLNING_START_KEY,\n      value: start.toISOString()\n    }\n  });\n  await prisma.adminSetting.upsert({\n    where: {\n      key: NOLLNING_END_KEY\n    },\n    update: {\n      value: end.toISOString()\n    },\n    create: {\n      key: NOLLNING_END_KEY,\n      value: end.toISOString()\n    }\n  });\n  const now = /* @__PURE__ */ new Date();\n  const isNollningPeriod2 = start < now && now < end;\n  cache = {\n    value: isNollningPeriod2,\n    lastFetched: now\n  };\n};\nexport {\n  NOLLNING_START_KEY as N,\n  NOLLNING_END_KEY as a,\n  isNollningPeriod as i,\n  updateNollningPeriod as u\n};\n"],"names":[],"mappings":"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"}