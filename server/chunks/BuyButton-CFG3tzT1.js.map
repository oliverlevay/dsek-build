{"version":3,"file":"BuyButton-CFG3tzT1.js","sources":["../../../.svelte-kit/adapter-node/chunks/BuyButton.js"],"sourcesContent":["import { a as subscribe, g as getContext } from \"./lifecycle.js\";\nimport { c as create_ssr_component, a as add_attribute, b as escape, v as validate_component } from \"./ssr.js\";\nimport { b as invalidate } from \"./client.js\";\nimport { p as page } from \"./stores.js\";\nimport { L as LoadingButton } from \"./LoadingButton.js\";\nimport { T as Timer, S as ScrollingNumber } from \"./ScrollingNumber.js\";\nimport { n as now } from \"./date.js\";\nimport { a as apiNames } from \"./apiNames.js\";\nimport { i as isAuthorized } from \"./authorization.js\";\nimport { hD as tickets_buyButton_partOfLottery, gV as cart_reservation_queuePosition, hE as tickets_buyButton_inQueue, hF as tickets_buyButton_inCart, hG as tickets_buyButton_soldOut, hH as tickets_buyButton_alreadyOwned, hI as tickets_buyButton_enterQueue, hJ as tickets_buyButton_getLotteryEntry, hK as tickets_buyButton_get, hL as tickets_buyButton_purchase, hM as tickets_buyButton_releasesIn, hN as tickets_buyButton_opensIn, hO as tickets_buyButton_logInToBuy } from \"./messages.js\";\nimport dayjs from \"dayjs\";\nimport { twMerge } from \"tailwind-merge\";\nconst BuyButton = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let cartPath;\n  let isUpcoming;\n  let isCurrentlyAvailable;\n  let isInGracePeriod;\n  let $now, $$unsubscribe_now;\n  let $page, $$unsubscribe_page;\n  $$unsubscribe_now = subscribe(now, (value) => $now = value);\n  $$unsubscribe_page = subscribe(page, (value) => $page = value);\n  let { isSubmitting } = $$props;\n  let { ticket } = $$props;\n  let { class: clazz = void 0 } = $$props;\n  const pArAgLiDe_translate_attribute_pass_context = getContext(\"$paraglide-adapter-sveltekit:context\");\n  function pArAgLiDe_translate_attribute_pass_translateAttribute(value, lang_value) {\n    if (typeof value !== \"string\") return value;\n    if (!pArAgLiDe_translate_attribute_pass_context) return value;\n    return pArAgLiDe_translate_attribute_pass_context.translateHref(value, lang_value);\n  }\n  if ($$props.isSubmitting === void 0 && $$bindings.isSubmitting && isSubmitting !== void 0) $$bindings.isSubmitting(isSubmitting);\n  if ($$props.ticket === void 0 && $$bindings.ticket && ticket !== void 0) $$bindings.ticket(ticket);\n  if ($$props.class === void 0 && $$bindings.class && clazz !== void 0) $$bindings.class(clazz);\n  cartPath = $page.data[\"paths\"]?.[\"cart\"] ?? \"/shop/cart\";\n  isUpcoming = ticket.availableFrom > $now;\n  isCurrentlyAvailable = !isUpcoming && (!ticket.availableTo || ticket.availableTo > $now);\n  isInGracePeriod = ticket.gracePeriodEndsAt > $now;\n  {\n    if (isCurrentlyAvailable && ticket.isInUsersCart && isInGracePeriod && $now > ticket.gracePeriodEndsAt) {\n      invalidate();\n    }\n  }\n  $$unsubscribe_now();\n  $$unsubscribe_page();\n  return ` ${isAuthorized(apiNames.WEBSHOP.PURCHASE, $page.data.user) ? `${isCurrentlyAvailable ? `${ticket.isInUsersCart ? `${isInGracePeriod ? `<span${add_attribute(\"class\", twMerge(\"text-xl\", clazz), 0)}>${escape(tickets_buyButton_partOfLottery())} ${validate_component(Timer, \"Timer\").$$render(\n    $$result,\n    {\n      milliseconds: ticket.gracePeriodEndsAt.valueOf() - $now.valueOf()\n    },\n    {},\n    {}\n  )}</span>` : `<a type=\"button\"${add_attribute(\"href\", pArAgLiDe_translate_attribute_pass_translateAttribute(cartPath, void 0), 0)} class=\"btn btn-primary\">${ticket.userReservations.length > 0 ? (() => {\n    let position = (ticket.userReservations[0]?.order ?? -100) + 1;\n    return ` ${position >= 0 ? `<span>${escape(cart_reservation_queuePosition())} ${validate_component(ScrollingNumber, \"ScrollingNumber\").$$render($$result, { number: position }, {}, {})}</span>` : `${escape(tickets_buyButton_inQueue())}`}`;\n  })() : `${escape(tickets_buyButton_inCart())}`}</a>`}` : `${validate_component(LoadingButton, \"LoadingButton\").$$render(\n    $$result,\n    {\n      type: \"submit\",\n      disabled: isSubmitting || ticket.userAlreadyHasMax || ticket.ticketsLeft <= 0,\n      class: \"btn btn-primary\",\n      onClick: (e) => {\n        e.stopPropagation();\n      }\n    },\n    {},\n    {\n      default: () => {\n        return `${ticket.ticketsLeft <= 0 ? `${escape(tickets_buyButton_soldOut())}` : `${ticket.userAlreadyHasMax ? `${escape(tickets_buyButton_alreadyOwned())}` : `${ticket.hasQueue ? `${escape(tickets_buyButton_enterQueue())}` : `${isInGracePeriod ? `${escape(tickets_buyButton_getLotteryEntry())}` : `${ticket.price === 0 ? `${escape(tickets_buyButton_get())}` : `${escape(tickets_buyButton_purchase())}`}`}`}`}`}`;\n      }\n    }\n  )}`}` : `${isUpcoming ? `${ticket.availableFrom.valueOf() - $now.valueOf() < 1e3 * 60 * 5 ? ` <span${add_attribute(\"class\", clazz, 0)}>${escape(tickets_buyButton_releasesIn())} ${validate_component(Timer, \"Timer\").$$render(\n    $$result,\n    {\n      milliseconds: ticket.availableFrom.valueOf() - $now.valueOf()\n    },\n    {},\n    {}\n  )}</span>` : `<span${add_attribute(\"class\", clazz, 0)}>${escape(tickets_buyButton_opensIn())} ${escape(dayjs(ticket.availableFrom).fromNow())}</span>`}` : ``}`}` : `<button type=\"button\" disabled class=\"btn btn-disabled\">${escape(tickets_buyButton_logInToBuy())}</button>`}`;\n});\nexport {\n  BuyButton as B\n};\n"],"names":[],"mappings":"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"}