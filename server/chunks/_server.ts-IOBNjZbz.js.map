{"version":3,"file":"_server.ts-IOBNjZbz.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/(app)/api/home/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../../chunks/index.js\";\nimport dayjs from \"dayjs\";\nconst cacheDuration = 600;\nlet commitCount;\nlet latestCommit;\nlet lastFetch;\nasync function GET() {\n  const now = dayjs();\n  if (!lastFetch || lastFetch.add(cacheDuration, \"s\").isBefore(now)) {\n    lastFetch = now;\n    const commit = await fetch(\n      \"https://api.github.com/repos/dsek-lth/web/commits?per_page=1\"\n    );\n    const regex = /\\d*(?=>; rel=\"last\")/;\n    const regexRes = regex.exec(commit.headers.get(\"link\") ?? \"\");\n    commitCount = regexRes ? regexRes[0] : \"0\";\n    const commitData = (await commit.json())[0];\n    if (!commitData) {\n      commitCount = \"not found\";\n      latestCommit = {\n        author: \"Not Found\",\n        message: \"Not found\",\n        avatarUrl: \"https://avatars.githubusercontent.com/u/15785880?v=4\",\n        url: \"\",\n        date: now.toISOString()\n      };\n    } else {\n      latestCommit = {\n        author: commitData.author.login,\n        message: commitData.commit.message,\n        avatarUrl: commitData.author.avatar_url,\n        url: commitData.html_url,\n        date: commitData.commit.committer.date\n      };\n    }\n  }\n  return json({ commitCount, latestCommit });\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,aAAa,GAAG,GAAG,CAAC;AAC1B,IAAI,WAAW,CAAC;AAChB,IAAI,YAAY,CAAC;AACjB,IAAI,SAAS,CAAC;AACd,eAAe,GAAG,GAAG;AACrB,EAAE,MAAM,GAAG,GAAG,KAAK,EAAE,CAAC;AACtB,EAAE,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,GAAG,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;AACrE,IAAI,SAAS,GAAG,GAAG,CAAC;AACpB,IAAI,MAAM,MAAM,GAAG,MAAM,KAAK;AAC9B,MAAM,8DAA8D;AACpE,KAAK,CAAC;AACN,IAAI,MAAM,KAAK,GAAG,sBAAsB,CAAC;AACzC,IAAI,MAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC;AAClE,IAAI,WAAW,GAAG,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;AAC/C,IAAI,MAAM,UAAU,GAAG,CAAC,MAAM,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;AAChD,IAAI,IAAI,CAAC,UAAU,EAAE;AACrB,MAAM,WAAW,GAAG,WAAW,CAAC;AAChC,MAAM,YAAY,GAAG;AACrB,QAAQ,MAAM,EAAE,WAAW;AAC3B,QAAQ,OAAO,EAAE,WAAW;AAC5B,QAAQ,SAAS,EAAE,sDAAsD;AACzE,QAAQ,GAAG,EAAE,EAAE;AACf,QAAQ,IAAI,EAAE,GAAG,CAAC,WAAW,EAAE;AAC/B,OAAO,CAAC;AACR,KAAK,MAAM;AACX,MAAM,YAAY,GAAG;AACrB,QAAQ,MAAM,EAAE,UAAU,CAAC,MAAM,CAAC,KAAK;AACvC,QAAQ,OAAO,EAAE,UAAU,CAAC,MAAM,CAAC,OAAO;AAC1C,QAAQ,SAAS,EAAE,UAAU,CAAC,MAAM,CAAC,UAAU;AAC/C,QAAQ,GAAG,EAAE,UAAU,CAAC,QAAQ;AAChC,QAAQ,IAAI,EAAE,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI;AAC9C,OAAO,CAAC;AACR,KAAK;AACL,GAAG;AACH,EAAE,OAAO,IAAI,CAAC,EAAE,WAAW,EAAE,YAAY,EAAE,CAAC,CAAC;AAC7C;;;;"}