import{s as Z,j as N,e as U,k as P,a as k,b as L,d,f as g,i as A,q as b,Q as V,R as x,l as ee,m as te,t as D,o as K,S as W,n as ae,G as re,w as ne,O as le}from"../chunks/scheduler.DK5noefF.js";import{S as se,i as oe,c as C,a as I,m as w,t as B,b as O,d as j}from"../chunks/index.OECaLbXR.js";import{e as R}from"../chunks/each.Dbd03sI1.js";import{e as ie}from"../chunks/forms.DDTWXYJD.js";import{P as X}from"../chunks/public.D6ikzIky.js";import{F as fe}from"../chunks/FormFileInput.mN0v36sS.js";import{F as M}from"../chunks/FormInput.DvRHd4up.js";import{F as me}from"../chunks/FormSubmitButton.zmtSKK1O.js";import{t as ue}from"../chunks/toast.BUMyavxw.js";import{a as z}from"../chunks/apiNames.G3FqMHey.js";import{i as G}from"../chunks/authorization.BfNSR1Nc.js";import{s as pe}from"../chunks/superForms.37TMp2uc.js";import{ap as Y,aq as ce}from"../chunks/messages.DZzIl59o.js";function H(a,r,t){const n=a.slice();return n[11]=r[t],n}function Q(a){let r,t,n,u=a[1].fileUrl+"",p;return{c(){r=U("span"),t=D("Filurl: "),n=U("span"),p=D(u),this.h()},l(i){r=k(i,"SPAN",{class:!0});var l=L(r);t=K(l,"Filurl: "),n=k(l,"SPAN",{class:!0});var $=L(n);p=K($,u),$.forEach(d),l.forEach(d),this.h()},h(){g(n,"class","font-medium"),g(r,"class","text-lg")},m(i,l){A(i,r,l),b(r,t),b(r,n),b(n,p)},p(i,l){l&2&&u!==(u=i[1].fileUrl+"")&&W(p,u)},d(i){i&&d(r)}}}function de(a){let r=Y()+"",t;return{c(){t=D(r)},l(n){t=K(n,r)},m(n,u){A(n,t,u)},p:ae,d(n){n&&d(t)}}}function J(a){let r,t,n=a[11].id.replace(a[0].prefix+"/","")+"",u,p,i,l,$,E,_,c,v,s,T,m;function y(){return a[7](a[11])}return{c(){r=U("li"),t=U("button"),u=D(n),p=N(),i=U("form"),l=U("input"),E=N(),_=U("button"),c=U("span"),s=N(),this.h()},l(o){r=k(o,"LI",{class:!0});var e=L(r);t=k(e,"BUTTON",{class:!0});var f=L(t);u=K(f,n),f.forEach(d),p=P(e),i=k(e,"FORM",{action:!0,method:!0});var h=L(i);l=k(h,"INPUT",{type:!0,name:!0}),E=P(h),_=k(h,"BUTTON",{class:!0});var S=L(_);c=k(S,"SPAN",{class:!0}),L(c).forEach(d),S.forEach(d),h.forEach(d),s=P(e),e.forEach(d),this.h()},h(){g(t,"class","btn join-item flex-1 select-all justify-start"),g(l,"type","hidden"),l.value=$=a[11].id,g(l,"name","id"),g(c,"class","i-mdi-delete"),g(_,"class","btn btn-error join-item"),_.disabled=v=!G(z.FILES.BUCKET(X).DELETE,a[0].user),g(i,"action",a[5]("?/delete",void 0)),g(i,"method","POST"),g(r,"class","join flex py-1")},m(o,e){A(o,r,e),b(r,t),b(t,u),b(r,p),b(r,i),b(i,l),b(i,E),b(i,_),b(_,c),b(r,s),T||(m=[re(t,"click",y),V(ie.call(null,i,a[8]))],T=!0)},p(o,e){a=o,e&1&&n!==(n=a[11].id.replace(a[0].prefix+"/","")+"")&&W(u,n),e&1&&$!==($=a[11].id)&&(l.value=$),e&1&&v!==(v=!G(z.FILES.BUCKET(X).DELETE,a[0].user))&&(_.disabled=v)},d(o){o&&d(r),T=!1,ne(m)}}}function _e(a){let r,t,n,u,p,i,l,$,E,_,c,v,s,T,m=a[1].fileUrl&&Q(a);n=new fe({props:{field:"file",superform:a[2],label:"Fil",onChange:a[6]}}),p=new M({props:{superform:a[2],field:"fileName",label:Y()}}),l=new M({props:{superform:a[2],field:"prefix",label:"Prefix",explanation:"Kommer lägga den i rätt mapp (typ /event/2024/XXX)"}}),E=new me({props:{superform:a[2],class:"btn btn-primary mt-4 self-start",$$slots:{default:[de]},$$scope:{ctx:a}}});let y=R(a[0].files),o=[];for(let e=0;e<y.length;e+=1)o[e]=J(H(a,y,e));return{c(){m&&m.c(),r=N(),t=U("form"),C(n.$$.fragment),u=N(),C(p.$$.fragment),i=N(),C(l.$$.fragment),$=N(),C(E.$$.fragment),_=N(),c=U("ul");for(let e=0;e<o.length;e+=1)o[e].c();this.h()},l(e){m&&m.l(e),r=P(e),t=k(e,"FORM",{method:!0,action:!0,enctype:!0,class:!0});var f=L(t);I(n.$$.fragment,f),u=P(f),I(p.$$.fragment,f),i=P(f),I(l.$$.fragment,f),$=P(f),I(E.$$.fragment,f),f.forEach(d),_=P(e),c=k(e,"UL",{class:!0});var h=L(c);for(let S=0;S<o.length;S+=1)o[S].l(h);h.forEach(d),this.h()},h(){g(t,"method","POST"),g(t,"action",a[5]("?/upload",void 0)),g(t,"enctype","multipart/form-data"),g(t,"class","form-control max-w-md rounded-box bg-base-200 p-4"),g(c,"class","mt-8 flex flex-col gap-1")},m(e,f){m&&m.m(e,f),A(e,r,f),A(e,t,f),w(n,t,null),b(t,u),w(p,t,null),b(t,i),w(l,t,null),b(t,$),w(E,t,null),A(e,_,f),A(e,c,f);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(c,null);v=!0,s||(T=V(a[3].call(null,t)),s=!0)},p(e,[f]){e[1].fileUrl?m?m.p(e,f):(m=Q(e),m.c(),m.m(r.parentNode,r)):m&&(m.d(1),m=null);const h={};f&2&&(h.onChange=e[6]),n.$set(h);const S={};if(f&16384&&(S.$$scope={dirty:f,ctx:e}),E.$set(S),f&33){y=R(e[0].files);let F;for(F=0;F<y.length;F+=1){const q=H(e,y,F);o[F]?o[F].p(q,f):(o[F]=J(q),o[F].c(),o[F].m(c,null))}for(;F<o.length;F+=1)o[F].d(1);o.length=y.length}},i(e){v||(B(n.$$.fragment,e),B(p.$$.fragment,e),B(l.$$.fragment,e),B(E.$$.fragment,e),v=!0)},o(e){O(n.$$.fragment,e),O(p.$$.fragment,e),O(l.$$.fragment,e),O(E.$$.fragment,e),v=!1},d(e){e&&(d(r),d(t),d(_),d(c)),m&&m.d(e),j(n),j(p),j(l),j(E),x(o,e),s=!1,T()}}}function he(a,r,t){let n,{data:u}=r;const p=pe(u.uploadForm,{dataType:"json"}),{enhance:i,form:l}=p;ee(a,l,s=>t(1,n=s));const $=te("$paraglide-adapter-sveltekit:context");function E(s,T){return typeof s!="string"||!$?s:$.translateHref(s,T)}const _=s=>{var T,m;s.currentTarget.files&&le(l,n.fileName=((m=(T=s.currentTarget.files)==null?void 0:T.item(0))==null?void 0:m.name.replace(/_+/g," ").replace(/\..+$/,""))??"",n)},c=s=>{s.thumbnailUrl&&(navigator.clipboard.writeText(s.thumbnailUrl),ue("Länk kopierad till urklipp","success"))},v=()=>{if(confirm(ce()+"?"))return({update:s})=>s()};return a.$$set=s=>{"data"in s&&t(0,u=s.data)},a.$$.update=()=>{a.$$.dirty&1&&console.log(u.files)},[u,n,p,i,l,E,_,c,v]}class Pe extends se{constructor(r){super(),oe(this,r,he,_e,Z,{data:0})}}export{Pe as component};
