import{n as S,a4 as Nt,s as ee,t as $,o as x,i as E,S as re,d as _,a3 as _t,e as I,a as A,L as Et,f as p,C as L,j as V,b as R,k as B,q as N,Q as se,G as Ae,x as pe,w as dt,l as be,m as Ne,E as he,r as ae,R as ce,p as Te,c as ht,u as mt,g as pt,h as bt,Y as Ce,a2 as Rt}from"./scheduler.DK5noefF.js";import{h as me,u as Dt}from"./await_block.BvqRVjl_.js";import{n as Tt,l as Ct,k as St,o as Pt,S as te,i as le,g as W,b as D,e as J,t as T,c as q,a as j,m as z,d as Y,f as Se}from"./index.OECaLbXR.js";import{p as ge}from"./stores.BdoTh84D.js";import{e as F,u as ke,o as Mt,f as Lt,d as gt}from"./each.Dbd03sI1.js";import{e as ve}from"./forms.DDTWXYJD.js";import{d as kt}from"./123.BVaw0gZK.js";import{d as de}from"./dayjs.min.B27XEuZS.js";import{M as Ee,C as Re}from"./MemberImage.B2gosKIu.js";import{g as Ot}from"./client.B-kH8QcR.js";import{i as Ie}from"./i18n.Cv4-1ZiX.js";import{P as Pe,O as we}from"./types.CTZXezes.js";import{hE as vt,hF as Ut,hG as Vt}from"./messages.DZzIl59o.js";import{t as Me}from"./bundle-mjs.BkWO730n.js";import{s as Le}from"./superForms.37TMp2uc.js";import{c as Bt}from"./index.Cq-ibvhb.js";import{t as ye}from"./toast.BUMyavxw.js";function Ht(i,e,n,t){if(!e)return S;const l=i.getBoundingClientRect();if(e.left===l.left&&e.right===l.right&&e.top===l.top&&e.bottom===l.bottom)return S;const{delay:o=0,duration:r=300,easing:s=Nt,start:a=Tt()+o,end:c=a+r,tick:f=S,css:d}=n(i,{from:e,to:l},t);let m=!0,u=!1,b;function v(){d&&(b=St(i,0,1,r,o,s,d)),o||(u=!0)}function k(){d&&Pt(i,b),m=!1}return Ct(g=>{if(!u&&g>=a&&(u=!0),u&&g>=c&&(f(1,0),k()),!m)return!1;if(u){const h=g-a,w=0+1*s(h/r);f(w,1-w)}return!0}),v(),f(0,1),k}function Ft(i){const e=getComputedStyle(i);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:n,height:t}=e,l=i.getBoundingClientRect();i.style.position="absolute",i.style.width=n,i.style.height=t,qt(i,l)}}function qt(i,e){const n=i.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const t=getComputedStyle(i),l=t.transform==="none"?"":t.transform;i.style.transform=`${l} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function jt(i){let e;return{c(){e=$(i[0])},l(n){e=x(n,i[0])},m(n,t){E(n,e,t)},p(n,[t]){t&1&&re(e,n[0])},i:S,o:S,d(n){n&&_(e)}}}const K={callbacks:[],interval:null,add:i=>(K.callbacks.push(i),K.interval===null&&(K.interval=setInterval(()=>{const e=Date.now();K.callbacks.forEach(n=>n(e))},1e3)),()=>{K.remove(i)}),remove:i=>{K.callbacks=K.callbacks.filter(e=>e!==i),K.callbacks.length===0&&K.interval&&(clearInterval(K.interval),K.interval=null)}};function zt(i,e,n){let t,{timeStamp:l}=e,o=Date.now();return _t(()=>{const r=K.add(s=>{n(2,o=s)});return()=>{r()}}),i.$$set=r=>{"timeStamp"in r&&n(1,l=r.timeStamp)},i.$$.update=()=>{i.$$.dirty&6&&n(0,t=de(l).diff(de(),"week")<-1?de(l).format("YYYY-MM-DD"):de(l).from(o))},[t,l,o]}class wt extends te{constructor(e){super(),le(this,e,zt,jt,ee,{timeStamp:1})}}function Yt(i){let e,n;return{c(){e=I("img"),this.h()},l(t){e=A(t,"IMG",{src:!0,alt:!0}),this.h()},h(){Et(e.src,n=Ot("https://raw.githubusercontent.com/Dsek-LTH/grafik/main/guild/d_sektionen/full/color.svg"))||p(e,"src",n),p(e,"alt","D-guild logo")},m(t,l){E(t,e,l)},p:S,i:S,o:S,d(t){t&&_(e)}}}class Gt extends te{constructor(e){super(),le(this,e,null,Yt,ee,{})}}function Wt(i){const e=i.slice(),n=e[0][0];return e[1]=n,e}function Jt(i){let e,n,t,l,o,r,s,a,c,f,d;const m=[Kt,Xt],u=[];function b(h,w){var C;return((C=h[0][1])==null?void 0:C.type)==="Custom"?0:1}l=b(i),o=u[l]=m[l](i);const v=[$t,Zt],k=[];function g(h,w){var C;return((C=h[0][0])==null?void 0:C.type)==="Custom"?0:1}return c=g(i),f=k[c]=v[c](i),{c(){e=I("div"),n=I("div"),t=I("div"),o.c(),r=V(),s=I("div"),a=I("div"),f.c(),this.h()},l(h){e=A(h,"DIV",{class:!0});var w=R(e);n=A(w,"DIV",{class:!0});var C=R(n);t=A(C,"DIV",{class:!0});var y=R(t);o.l(y),y.forEach(_),C.forEach(_),r=B(w),s=A(w,"DIV",{class:!0});var P=R(s);a=A(P,"DIV",{class:!0});var X=R(a);f.l(X),X.forEach(_),P.forEach(_),w.forEach(_),this.h()},h(){p(t,"class","w-9 rounded-full"),p(n,"class","avatar absolute left-0 top-0"),p(a,"class","w-9 rounded-full"),p(s,"class","avatar absolute left-3 top-3"),p(e,"class","relative h-12 w-12")},m(h,w){E(h,e,w),N(e,n),N(n,t),u[l].m(t,null),N(e,r),N(e,s),N(s,a),k[c].m(a,null),d=!0},p(h,w){let C=l;l=b(h),l===C?u[l].p(h,w):(W(),D(u[C],1,1,()=>{u[C]=null}),J(),o=u[l],o?o.p(h,w):(o=u[l]=m[l](h),o.c()),T(o,1),o.m(t,null));let y=c;c=g(h),c===y?k[c].p(h,w):(W(),D(k[y],1,1,()=>{k[y]=null}),J(),f=k[c],f?f.p(h,w):(f=k[c]=v[c](h),f.c()),T(f,1),f.m(a,null))},i(h){d||(T(o),T(f),d=!0)},o(h){D(o),D(f),d=!1},d(h){h&&_(e),u[l].d(),k[c].d()}}}function Qt(i){let e,n,t,l,o;const r=[el,xt],s=[];function a(f,d){return f[0][0]===void 0?0:1}function c(f,d){return d===1?Wt(f):f}return t=a(i),l=s[t]=r[t](c(i,t)),{c(){e=I("div"),n=I("div"),l.c(),this.h()},l(f){e=A(f,"DIV",{class:!0});var d=R(e);n=A(d,"DIV",{class:!0});var m=R(n);l.l(m),m.forEach(_),d.forEach(_),this.h()},h(){p(n,"class","w-12 rounded-full"),p(e,"class","avatar")},m(f,d){E(f,e,d),N(e,n),s[t].m(n,null),o=!0},p(f,d){let m=t;t=a(f),t===m?s[t].p(c(f,t),d):(W(),D(s[m],1,1,()=>{s[m]=null}),J(),l=s[t],l?l.p(c(f,t),d):(l=s[t]=r[t](c(f,t)),l.c()),T(l,1),l.m(n,null))},i(f){o||(T(l),o=!0)},o(f){D(l),o=!1},d(f){f&&_(e),s[t].d()}}}function Xt(i){var t;let e,n;return e=new Ee({props:{member:((t=i[0][1])==null?void 0:t.member)??{picturePath:null}}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){var s;const r={};o&1&&(r.member=((s=l[0][1])==null?void 0:s.member)??{picturePath:null}),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function Kt(i){var t;let e,n;return e=new Re({props:{customAuthor:(t=i[0][1])==null?void 0:t.customAuthor}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){var s;const r={};o&1&&(r.customAuthor=(s=l[0][1])==null?void 0:s.customAuthor),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function Zt(i){var t;let e,n;return e=new Ee({props:{member:((t=i[0][0])==null?void 0:t.member)??{picturePath:null}}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){var s;const r={};o&1&&(r.member=((s=l[0][0])==null?void 0:s.member)??{picturePath:null}),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function $t(i){var t;let e,n;return e=new Re({props:{customAuthor:(t=i[0][0])==null?void 0:t.customAuthor}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){var s;const r={};o&1&&(r.customAuthor=(s=l[0][0])==null?void 0:s.customAuthor),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function xt(i){let e,n,t,l;const o=[ll,tl],r=[];function s(a,c){var f;return((f=a[0][0])==null?void 0:f.type)==="Custom"?0:1}return e=s(i),n=r[e]=o[e](i),{c(){n.c(),t=L()},l(a){n.l(a),t=L()},m(a,c){r[e].m(a,c),E(a,t,c),l=!0},p(a,c){let f=e;e=s(a),e===f?r[e].p(a,c):(W(),D(r[f],1,1,()=>{r[f]=null}),J(),n=r[e],n?n.p(a,c):(n=r[e]=o[e](a),n.c()),T(n,1),n.m(t.parentNode,t))},i(a){l||(T(n),l=!0)},o(a){D(n),l=!1},d(a){a&&_(t),r[e].d(a)}}}function el(i){let e,n;return e=new Gt({}),{c(){q(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,l){z(e,t,l),n=!0},p:S,i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function tl(i){let e,n;return e=new Ee({props:{member:i[1].member}}),{c(){q(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,l){z(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.member=t[1].member),e.$set(o)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function ll(i){let e,n;return e=new Re({props:{customAuthor:i[1].customAuthor}}),{c(){q(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,l){z(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.customAuthor=t[1].customAuthor),e.$set(o)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function nl(i){let e,n,t,l;const o=[Qt,Jt],r=[];function s(a,c){return a[0].length<=1?0:1}return e=s(i),n=r[e]=o[e](i),{c(){n.c(),t=L()},l(a){n.l(a),t=L()},m(a,c){r[e].m(a,c),E(a,t,c),l=!0},p(a,[c]){let f=e;e=s(a),e===f?r[e].p(a,c):(W(),D(r[f],1,1,()=>{r[f]=null}),J(),n=r[e],n?n.p(a,c):(n=r[e]=o[e](a),n.c()),T(n,1),n.m(t.parentNode,t))},i(a){l||(T(n),l=!0)},o(a){D(n),l=!1},d(a){a&&_(t),r[e].d(a)}}}function il(i,e,n){let{authors:t}=e;return i.$$set=l=>{"authors"in l&&n(0,t=l.authors)},[t]}class yt extends te{constructor(e){super(),le(this,e,il,nl,ee,{authors:0})}}function Oe(i,e,n){const t=i.slice();return t[14]=e[n],t}function Ue(i,e,n){const t=i.slice();return t[14]=e[n],t}function ol(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationId"),e.value=n=i[0].id},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[0].id)&&(e.value=n)},d(t){t&&_(e)}}}function rl(i){let e,n=F(i[0].individualIds),t=[];for(let l=0;l<n.length;l+=1)t[l]=Ve(Ue(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let o=0;o<t.length;o+=1)t[o].l(l);e=L()},m(l,o){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,o);E(l,e,o)},p(l,o){if(o&1){n=F(l[0].individualIds);let r;for(r=0;r<n.length;r+=1){const s=Ue(l,n,r);t[r]?t[r].p(s,o):(t[r]=Ve(s),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},d(l){l&&_(e),ce(t,l)}}}function Ve(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationIds"),e.value=n=i[14]},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[14])&&(e.value=n)},d(t){t&&_(e)}}}function Be(i){let e,n,t,l='<span class="i-mdi-delete-outline mx-0 opacity-50"></span>',o,r;function s(f,d){return f[0].individualIds.length>1?sl:al}let a=s(i),c=a(i);return{c(){e=I("form"),c.c(),n=V(),t=I("button"),t.innerHTML=l,this.h()},l(f){e=A(f,"FORM",{class:!0,method:!0,action:!0});var d=R(e);c.l(d),n=B(d),t=A(d,"BUTTON",{class:!0,"data-svelte-h":!0}),he(t)!=="svelte-1syasgq"&&(t.innerHTML=l),d.forEach(_),this.h()},h(){p(t,"class","btn btn-ghost -mr-2 rounded-none !px-2 *:text-2xl"),p(e,"class","flex items-stretch"),p(e,"method","POST"),p(e,"action",i[6]("/notifications?/deleteNotification",void 0))},m(f,d){E(f,e,d),c.m(e,null),N(e,n),N(e,t),o||(r=se(ve.call(null,e)),o=!0)},p(f,d){a===(a=s(f))&&c?c.p(f,d):(c.d(1),c=a(f),c&&(c.c(),c.m(e,n)))},d(f){f&&_(e),c.d(),o=!1,r()}}}function al(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationId"),e.value=n=i[0].id},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[0].id)&&(e.value=n)},d(t){t&&_(e)}}}function sl(i){let e,n=F(i[0].individualIds),t=[];for(let l=0;l<n.length;l+=1)t[l]=He(Oe(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let o=0;o<t.length;o+=1)t[o].l(l);e=L()},m(l,o){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,o);E(l,e,o)},p(l,o){if(o&1){n=F(l[0].individualIds);let r;for(r=0;r<n.length;r+=1){const s=Oe(l,n,r);t[r]?t[r].p(s,o):(t[r]=He(s),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},d(l){l&&_(e),ce(t,l)}}}function He(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationIds"),e.value=n=i[14]},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[14])&&(e.value=n)},d(t){t&&_(e)}}}function cl(i){let e,n,t,l,o,r,s,a,c,f=i[0].title+"",d,m,u,b=i[0].message+"",v,k,g,h,w,C,y,P,X,fe;function oe(M,H){return M[0].individualIds.length>1?rl:ol}let G=oe(i),U=G(i);r=new yt({props:{authors:i[5]}}),h=new wt({props:{timeStamp:i[0].createdAt.getTime()}});let O=i[1]&&Be(i);return{c(){e=I("div"),n=I("form"),U.c(),t=V(),l=I("a"),o=I("div"),q(r.$$.fragment),s=V(),a=I("div"),c=I("span"),d=$(f),m=V(),u=I("span"),v=$(b),k=V(),g=I("span"),q(h.$$.fragment),y=V(),O&&O.c(),this.h()},l(M){e=A(M,"DIV",{class:!0});var H=R(e);n=A(H,"FORM",{method:!0,action:!0,class:!0,"aria-hidden":!0});var Q=R(n);U.l(Q),Q.forEach(_),t=B(H),l=A(H,"A",{href:!0,class:!0});var Z=R(l);o=A(Z,"DIV",{});var ne=R(o);j(r.$$.fragment,ne),ne.forEach(_),s=B(Z),a=A(Z,"DIV",{class:!0});var ie=R(a);c=A(ie,"SPAN",{class:!0});var ue=R(c);d=x(ue,f),ue.forEach(_),m=B(ie),u=A(ie,"SPAN",{class:!0});var _e=R(u);v=x(_e,b),_e.forEach(_),k=B(ie),g=A(ie,"SPAN",{class:!0});var De=R(g);j(h.$$.fragment,De),De.forEach(_),ie.forEach(_),Z.forEach(_),y=B(H),O&&O.l(H),H.forEach(_),this.h()},h(){p(n,"method","POST"),p(n,"action",i[6]("/notifications?/readNotifications",void 0)),p(n,"class","hidden"),p(n,"aria-hidden","true"),p(c,"class","mt-1 line-clamp-1 text-base"),p(u,"class","mb-1 line-clamp-2 text-ellipsis break-words text-xs"),p(g,"class","line-clamp-1 text-xs text-gray-500"),p(a,"class",w="flex h-full flex-1 flex-col flex-nowrap items-stretch justify-center "+(i[3]?"font-medium":"opacity-80")),p(l,"href",C=i[6](i[0].link,void 0)),p(l,"class","flex max-w-full flex-1 items-center gap-4 overflow-hidden"),p(e,"class","relative flex w-full items-stretch rounded-none p-2")},m(M,H){E(M,e,H),N(e,n),U.m(n,null),i[10](n),N(e,t),N(e,l),N(l,o),z(r,o,null),N(l,s),N(l,a),N(a,c),N(c,d),N(a,m),N(a,u),N(u,v),N(a,k),N(a,g),z(h,g,null),N(e,y),O&&O.m(e,null),P=!0,X||(fe=[se(ve.call(null,n)),Ae(l,"click",function(){pe(i[2])&&i[2].apply(this,arguments)})],X=!0)},p(M,[H]){i=M,G===(G=oe(i))&&U?U.p(i,H):(U.d(1),U=G(i),U&&(U.c(),U.m(n,null)));const Q={};H&32&&(Q.authors=i[5]),r.$set(Q),(!P||H&1)&&f!==(f=i[0].title+"")&&re(d,f),(!P||H&1)&&b!==(b=i[0].message+"")&&re(v,b);const Z={};H&1&&(Z.timeStamp=i[0].createdAt.getTime()),h.$set(Z),(!P||H&8&&w!==(w="flex h-full flex-1 flex-col flex-nowrap items-stretch justify-center "+(i[3]?"font-medium":"opacity-80")))&&p(a,"class",w),(!P||H&1&&C!==(C=i[6](i[0].link,void 0)))&&p(l,"href",C),i[1]?O?O.p(i,H):(O=Be(i),O.c(),O.m(e,null)):O&&(O.d(1),O=null)},i(M){P||(T(r.$$.fragment,M),T(h.$$.fragment,M),P=!0)},o(M){D(r.$$.fragment,M),D(h.$$.fragment,M),P=!1},d(M){M&&_(e),U.d(),i[10](null),Y(r),Y(h),O&&O.d(),X=!1,dt(fe)}}}function fl(i,e,n){let t,l,o,r;be(i,ge,k=>n(9,r=k));let{notification:s}=e,{allowDelete:a=!0}=e,{onClick:c=void 0}=e,{onRead:f=void 0}=e,d;const m=()=>{console.log("reading notification"),d==null||d.requestSubmit(),f==null||f(),kt("/api/notifications/my")},u=Ne("$paraglide-adapter-sveltekit:context");function b(k,g){return typeof k!="string"||!u?k:u.translateHref(k,g)}function v(k){ae[k?"unshift":"push"](()=>{d=k,n(4,d)})}return i.$$set=k=>{"notification"in k&&n(0,s=k.notification),"allowDelete"in k&&n(1,a=k.allowDelete),"onClick"in k&&n(2,c=k.onClick),"onRead"in k&&n(7,f=k.onRead)},i.$$.update=()=>{i.$$.dirty&1&&n(3,t=s.readAt===null),i.$$.dirty&513&&n(8,l=Ie.route(r.url.pathname)===s.link),i.$$.dirty&264&&t&&l&&setTimeout(()=>{m()}),i.$$.dirty&1&&n(5,o=s.authors.filter(Boolean))},[s,a,c,t,d,o,b,f,l,r,v]}class It extends te{constructor(e){super(),le(this,e,fl,cl,ee,{notification:0,allowDelete:1,onClick:2,onRead:7})}}function Fe(i,e,n){const t=i.slice();return t[16]=e[n],t}function qe(i,e,n){const t=i.slice();return t[16]=e[n],t}function ul(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationId"),e.value=n=i[0].id},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[0].id)&&(e.value=n)},d(t){t&&_(e)}}}function _l(i){let e,n=F(i[0].individualIds),t=[];for(let l=0;l<n.length;l+=1)t[l]=je(qe(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let o=0;o<t.length;o+=1)t[o].l(l);e=L()},m(l,o){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,o);E(l,e,o)},p(l,o){if(o&1){n=F(l[0].individualIds);let r;for(r=0;r<n.length;r+=1){const s=qe(l,n,r);t[r]?t[r].p(s,o):(t[r]=je(s),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},d(l){l&&_(e),ce(t,l)}}}function je(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationIds"),e.value=n=i[16]},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[16])&&(e.value=n)},d(t){t&&_(e)}}}function ze(i){let e,n,t,l='<span class="i-mdi-delete-outline mx-0 opacity-50"></span>',o,r;function s(f,d){return f[0].individualIds.length>1?hl:dl}let a=s(i),c=a(i);return{c(){e=I("form"),c.c(),n=V(),t=I("button"),t.innerHTML=l,this.h()},l(f){e=A(f,"FORM",{class:!0,method:!0,action:!0});var d=R(e);c.l(d),n=B(d),t=A(d,"BUTTON",{class:!0,"data-svelte-h":!0}),he(t)!=="svelte-1syasgq"&&(t.innerHTML=l),d.forEach(_),this.h()},h(){p(t,"class","btn btn-ghost -mr-2 rounded-none !px-2 *:text-2xl"),p(e,"class","flex items-stretch"),p(e,"method","POST"),p(e,"action",i[7]("/notifications?/deleteNotification",void 0))},m(f,d){E(f,e,d),c.m(e,null),N(e,n),N(e,t),o||(r=se(ve.call(null,e)),o=!0)},p(f,d){a===(a=s(f))&&c?c.p(f,d):(c.d(1),c=a(f),c&&(c.c(),c.m(e,n)))},d(f){f&&_(e),c.d(),o=!1,r()}}}function dl(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationId"),e.value=n=i[0].id},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[0].id)&&(e.value=n)},d(t){t&&_(e)}}}function hl(i){let e,n=F(i[0].individualIds),t=[];for(let l=0;l<n.length;l+=1)t[l]=Ye(Fe(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let o=0;o<t.length;o+=1)t[o].l(l);e=L()},m(l,o){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,o);E(l,e,o)},p(l,o){if(o&1){n=F(l[0].individualIds);let r;for(r=0;r<n.length;r+=1){const s=Fe(l,n,r);t[r]?t[r].p(s,o):(t[r]=Ye(s),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},d(l){l&&_(e),ce(t,l)}}}function Ye(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationIds"),e.value=n=i[16]},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[16])&&(e.value=n)},d(t){t&&_(e)}}}function ml(i){let e,n,t,l,o,r,s,a,c,f=i[0].title+"",d,m,u,b=i[0].message+"",v,k,g,h,w,C,y,P,X;function fe(O,M){return O[0].individualIds.length>1?_l:ul}let oe=fe(i),G=oe(i);r=new yt({props:{authors:i[6]}}),h=new wt({props:{timeStamp:i[0].createdAt.getTime()}});let U=i[1]&&ze(i);return{c(){e=I("div"),n=I("form"),G.c(),t=V(),l=I("a"),o=I("div"),q(r.$$.fragment),s=V(),a=I("div"),c=I("span"),d=$(f),m=V(),u=I("span"),v=$(b),k=V(),g=I("span"),q(h.$$.fragment),C=V(),U&&U.c(),this.h()},l(O){e=A(O,"DIV",{class:!0});var M=R(e);n=A(M,"FORM",{method:!0,action:!0,class:!0,"aria-hidden":!0});var H=R(n);G.l(H),H.forEach(_),t=B(M),l=A(M,"A",{href:!0,class:!0});var Q=R(l);o=A(Q,"DIV",{});var Z=R(o);j(r.$$.fragment,Z),Z.forEach(_),s=B(Q),a=A(Q,"DIV",{class:!0});var ne=R(a);c=A(ne,"SPAN",{class:!0});var ie=R(c);d=x(ie,f),ie.forEach(_),m=B(ne),u=A(ne,"SPAN",{class:!0});var ue=R(u);v=x(ue,b),ue.forEach(_),k=B(ne),g=A(ne,"SPAN",{class:!0});var _e=R(g);j(h.$$.fragment,_e),_e.forEach(_),ne.forEach(_),Q.forEach(_),C=B(M),U&&U.l(M),M.forEach(_),this.h()},h(){p(n,"method","POST"),p(n,"action",i[7]("/notifications?/readNotifications",void 0)),p(n,"class","hidden"),p(n,"aria-hidden","true"),p(c,"class","mt-1 line-clamp-1 text-base"),p(u,"class","mb-1 line-clamp-2 text-ellipsis break-words text-xs text-neutral"),p(g,"class","line-clamp-1 text-xs text-base-300"),p(a,"class","flex h-full flex-1 flex-col flex-nowrap items-stretch justify-center"),p(l,"href",w=i[7](i[4],void 0)),p(l,"class","flex max-w-full flex-1 items-center gap-4 overflow-hidden"),p(e,"class","relative flex w-full items-stretch rounded-none p-2"),Te(e,"bg-base-200",i[3])},m(O,M){E(O,e,M),N(e,n),G.m(n,null),i[11](n),N(e,t),N(e,l),N(l,o),z(r,o,null),N(l,s),N(l,a),N(a,c),N(c,d),N(a,m),N(a,u),N(u,v),N(a,k),N(a,g),z(h,g,null),N(e,C),U&&U.m(e,null),y=!0,P||(X=[se(ve.call(null,n)),Ae(l,"click",function(){pe(i[2])&&i[2].apply(this,arguments)})],P=!0)},p(O,[M]){i=O,oe===(oe=fe(i))&&G?G.p(i,M):(G.d(1),G=oe(i),G&&(G.c(),G.m(n,null)));const H={};M&64&&(H.authors=i[6]),r.$set(H),(!y||M&1)&&f!==(f=i[0].title+"")&&re(d,f),(!y||M&1)&&b!==(b=i[0].message+"")&&re(v,b);const Q={};M&1&&(Q.timeStamp=i[0].createdAt.getTime()),h.$set(Q),(!y||M&16&&w!==(w=i[7](i[4],void 0)))&&p(l,"href",w),i[1]?U?U.p(i,M):(U=ze(i),U.c(),U.m(e,null)):U&&(U.d(1),U=null),(!y||M&8)&&Te(e,"bg-base-200",i[3])},i(O){y||(T(r.$$.fragment,O),T(h.$$.fragment,O),y=!0)},o(O){D(r.$$.fragment,O),D(h.$$.fragment,O),y=!1},d(O){O&&_(e),G.d(),i[11](null),Y(r),Y(h),U&&U.d(),P=!1,dt(X)}}}function pl(i,e,n){let t,l,o,r,s;be(i,ge,h=>n(10,s=h));const a=h=>{var C;const w=we.findIndex(y=>h.startsWith(y.from));return w===-1?h:we[w].to??`${Pe}${(C=we[w])==null?void 0:C.from}`};let{notification:c}=e,{allowDelete:f=!0}=e,{onClick:d=void 0}=e,{onRead:m=void 0}=e,u;const b=()=>{m==null||m(),u==null||u.requestSubmit(),kt("/api/notifications/my")},v=Ne("$paraglide-adapter-sveltekit:context");function k(h,w){return typeof h!="string"||!v?h:v.translateHref(h,w)}function g(h){ae[h?"unshift":"push"](()=>{u=h,n(5,u)})}return i.$$set=h=>{"notification"in h&&n(0,c=h.notification),"allowDelete"in h&&n(1,f=h.allowDelete),"onClick"in h&&n(2,d=h.onClick),"onRead"in h&&n(8,m=h.onRead)},i.$$.update=()=>{i.$$.dirty&1&&n(4,t=a(c.link)),i.$$.dirty&1&&n(3,l=c.readAt===null),i.$$.dirty&1040&&n(9,o=Ie.route(s.url.pathname)===t||t.startsWith("/news/")&&Ie.route(s.url.pathname).startsWith(`${Pe}/messages`)),i.$$.dirty&520&&l&&o&&setTimeout(()=>{b()}),i.$$.dirty&1&&n(6,r=c.authors.filter(Boolean))},[c,f,d,l,t,u,r,k,m,o,s,g]}class At extends te{constructor(e){super(),le(this,e,pl,ml,ee,{notification:0,allowDelete:1,onClick:2,onRead:8})}}function Ge(i,e,n){const t=i.slice();return t[10]=e[n],t}function bl(i){let e;return{c(){e=I("span"),this.h()},l(n){e=A(n,"SPAN",{class:!0}),R(e).forEach(_),this.h()},h(){p(e,"class","loading loading-lg mx-auto self-center")},m(n,t){E(n,e,t)},p:S,i:S,o:S,d(n){n&&_(e)}}}function gl(i){let e,n,t,l;const o=[vl,kl],r=[];function s(a,c){return a[1].length>0?0:1}return n=s(i),t=r[n]=o[n](i),{c(){e=I("ul"),t.c(),this.h()},l(a){e=A(a,"UL",{class:!0});var c=R(e);t.l(c),c.forEach(_),this.h()},h(){p(e,"class","-mx-6 flex-nowrap overflow-y-auto")},m(a,c){E(a,e,c),r[n].m(e,null),l=!0},p(a,c){let f=n;n=s(a),n===f?r[n].p(a,c):(W(),D(r[f],1,1,()=>{r[f]=null}),J(),t=r[n],t?t.p(a,c):(t=r[n]=o[n](a),t.c()),T(t,1),t.m(e,null))},i(a){l||(T(t),l=!0)},o(a){D(t),l=!1},d(a){a&&_(e),r[n].d()}}}function kl(i){let e,n=vt()+"",t;return{c(){e=I("li"),t=$(n),this.h()},l(l){e=A(l,"LI",{class:!0});var o=R(e);t=x(o,n),o.forEach(_),this.h()},h(){p(e,"class","p-4")},m(l,o){E(l,e,o),N(e,t)},p:S,i:S,o:S,d(l){l&&_(e)}}}function vl(i){let e=[],n=new Map,t,l,o=F(i[1]);const r=s=>s[10].id;for(let s=0;s<o.length;s+=1){let a=Ge(i,o,s),c=r(a);n.set(c,e[s]=We(c,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();t=L()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);t=L()},m(s,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(s,a);E(s,t,a),l=!0},p(s,a){a&31&&(o=F(s[1]),W(),e=ke(e,a,r,1,s,o,n,t.parentNode,Mt,We,t,Ge),J())},i(s){if(!l){for(let a=0;a<o.length;a+=1)T(e[a]);l=!0}},o(s){for(let a=0;a<e.length;a+=1)D(e[a]);l=!1},d(s){s&&_(t);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function wl(i){let e,n;function t(){return i[8](i[10])}return e=new It({props:{onClick:i[7],allowDelete:i[2],notification:i[10],onRead:t}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){i=l;const r={};o&1&&(r.onClick=i[7]),o&4&&(r.allowDelete=i[2]),o&2&&(r.notification=i[10]),o&18&&(r.onRead=t),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function yl(i){let e,n;function t(){return i[6](i[10])}return e=new At({props:{onClick:i[5],allowDelete:i[2],notification:i[10],onRead:t}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){i=l;const r={};o&1&&(r.onClick=i[5]),o&4&&(r.allowDelete=i[2]),o&2&&(r.notification=i[10]),o&18&&(r.onRead=t),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function We(i,e){let n,t,l,o,r;const s=[yl,wl],a=[];function c(f,d){return f[3]?0:1}return t=c(e),l=a[t]=s[t](e),{key:i,first:null,c(){n=I("li"),l.c(),o=V(),this.h()},l(f){n=A(f,"LI",{});var d=R(n);l.l(d),o=B(d),d.forEach(_),this.h()},h(){this.first=n},m(f,d){E(f,n,d),a[t].m(n,null),N(n,o),r=!0},p(f,d){e=f;let m=t;t=c(e),t===m?a[t].p(e,d):(W(),D(a[m],1,1,()=>{a[m]=null}),J(),l=a[t],l?l.p(e,d):(l=a[t]=s[t](e),l.c()),T(l,1),l.m(n,o))},i(f){r||(T(l),r=!0)},o(f){D(l),r=!1},d(f){f&&_(n),a[t].d()}}}function Il(i){let e,n,t,l,o,r,s='<button class="btn btn-circle btn-ghost btn-sm absolute right-2 top-2 z-10 bg-base-100">✕</button>',a,c,f="<button>close</button>",d;const m=[gl,bl],u=[];function b(v,k){return v[1]!==void 0?0:1}return t=b(i),l=u[t]=m[t](i),{c(){e=I("dialog"),n=I("div"),l.c(),o=V(),r=I("form"),r.innerHTML=s,a=V(),c=I("form"),c.innerHTML=f,this.h()},l(v){e=A(v,"DIALOG",{id:!0,class:!0});var k=R(e);n=A(k,"DIV",{class:!0});var g=R(n);l.l(g),o=B(g),r=A(g,"FORM",{method:!0,"data-svelte-h":!0}),he(r)!=="svelte-wo755c"&&(r.innerHTML=s),g.forEach(_),a=B(k),c=A(k,"FORM",{method:!0,class:!0,"data-svelte-h":!0}),he(c)!=="svelte-povsts"&&(c.innerHTML=f),k.forEach(_),this.h()},h(){p(r,"method","dialog"),p(n,"class","modal-box relative flex h-[calc(100dvh-8rem)] w-[calc(100dvw-2rem)] flex-col flex-nowrap"),p(c,"method","dialog"),p(c,"class","modal-backdrop"),p(e,"id","notificationModal"),p(e,"class","modal")},m(v,k){E(v,e,k),N(e,n),u[t].m(n,null),N(n,o),N(n,r),N(e,a),N(e,c),i[9](e),d=!0},p(v,[k]){let g=t;t=b(v),t===g?u[t].p(v,k):(W(),D(u[g],1,1,()=>{u[g]=null}),J(),l=u[t],l?l.p(v,k):(l=u[t]=m[t](v),l.c()),T(l,1),l.m(n,o))},i(v){d||(T(l),d=!0)},o(v){D(l),d=!1},d(v){v&&_(e),u[t].d(),i[9](null)}}}function Al(i,e,n){let{modal:t}=e,{notifications:l=void 0}=e,{allowDelete:o=!0}=e,{postReveal:r=!1}=e,{onRead:s=u=>{console.log("onRead"),u==="all"?n(1,l=l==null?void 0:l.map(b=>({...b,readAt:new Date}))):n(1,l=l==null?void 0:l.map(b=>b.id===u?{...b,readAt:new Date}:b)),n(1,l),console.log(l==null?void 0:l.filter(b=>!b.readAt).length)}}=e;const a=()=>t.close(),c=u=>s(u.id),f=()=>t.close(),d=u=>s(u.id);function m(u){ae[u?"unshift":"push"](()=>{t=u,n(0,t)})}return i.$$set=u=>{"modal"in u&&n(0,t=u.modal),"notifications"in u&&n(1,l=u.notifications),"allowDelete"in u&&n(2,o=u.allowDelete),"postReveal"in u&&n(3,r=u.postReveal),"onRead"in u&&n(4,s=u.onRead)},[t,l,o,r,s,a,c,f,d,m]}class Nl extends te{constructor(e){super(),le(this,e,Al,Il,ee,{modal:0,notifications:1,allowDelete:2,postReveal:3,onRead:4})}}function El(i,{from:e,to:n},t={}){const l=getComputedStyle(i),o=l.transform==="none"?"":l.transform,[r,s]=l.transformOrigin.split(" ").map(parseFloat),a=e.left+e.width*r/n.width-(n.left+r),c=e.top+e.height*s/n.height-(n.top+s),{delay:f=0,duration:d=u=>Math.sqrt(u)*120,easing:m=Bt}=t;return{delay:f,duration:pe(d)?d(Math.sqrt(a*a+c*c)):d,easing:m,css:(u,b)=>{const v=b*a,k=b*c,g=u+b*e.width/n.width,h=u+b*e.height/n.height;return`transform: ${o} translate(${v}px, ${k}px) scale(${g}, ${h});`}}}function Je(i,e,n){const t=i.slice();return t[11]=e[n],t}function Qe(i,e,n){const t=i.slice();return t[14]=e[n],t}function Xe(i,e,n){const t=i.slice();return t[11]=e[n],t}function Ke(i,e,n){const t=i.slice();return t[14]=e[n],t}function Ze(i,e,n){const t=i.slice();return t[11]=e[n],t}function Rl(i){let e,n=vt()+"",t;return{c(){e=I("li"),t=$(n),this.h()},l(l){e=A(l,"LI",{class:!0});var o=R(e);t=x(o,n),o.forEach(_),this.h()},h(){p(e,"class","p-4")},m(l,o){E(l,e,o),N(e,t)},p:S,i:S,o:S,d(l){l&&_(e)}}}function Dl(i){var b,v,k;let e,n=[],t=new Map,l,o=((v=(b=i[0])==null?void 0:b.filter(at))==null?void 0:v.length)>0,r,s=((k=i[0])==null?void 0:k.flatMap(rt).length)>0,a,c,f=F(i[0]);const d=g=>g[11].id;for(let g=0;g<f.length;g+=1){let h=Ze(i,f,g),w=d(h);t.set(w,n[g]=$e(w,h))}let m=o&&xe(i),u=s&&nt(i);return{c(){e=I("div");for(let g=0;g<n.length;g+=1)n[g].c();l=V(),m&&m.c(),r=V(),u&&u.c(),a=L(),this.h()},l(g){e=A(g,"DIV",{class:!0});var h=R(e);for(let w=0;w<n.length;w+=1)n[w].l(h);h.forEach(_),l=B(g),m&&m.l(g),r=B(g),u&&u.l(g),a=L(),this.h()},h(){p(e,"class","overflow-y-auto")},m(g,h){E(g,e,h);for(let w=0;w<n.length;w+=1)n[w]&&n[w].m(e,null);E(g,l,h),m&&m.m(g,h),E(g,r,h),u&&u.m(g,h),E(g,a,h),c=!0},p(g,h){var w,C,y;if(h&7){f=F(g[0]),W();for(let P=0;P<n.length;P+=1)n[P].r();n=ke(n,h,d,1,g,f,t,e,Lt,$e,null,Ze);for(let P=0;P<n.length;P+=1)n[P].a();J()}h&1&&(o=((C=(w=g[0])==null?void 0:w.filter(at))==null?void 0:C.length)>0),o?m?m.p(g,h):(m=xe(g),m.c(),m.m(r.parentNode,r)):m&&(m.d(1),m=null),h&1&&(s=((y=g[0])==null?void 0:y.flatMap(rt).length)>0),s?u?u.p(g,h):(u=nt(g),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},i(g){if(!c){for(let h=0;h<f.length;h+=1)T(n[h]);c=!0}},o(g){for(let h=0;h<n.length;h+=1)D(n[h]);c=!1},d(g){g&&(_(e),_(l),_(r),_(a));for(let h=0;h<n.length;h+=1)n[h].d();m&&m.d(g),u&&u.d(g)}}}function Tl(i){let e,n;function t(){return i[8](i[11])}return e=new It({props:{notification:i[11],onRead:t}}),{c(){q(e.$$.fragment)},l(l){j(e.$$.fragment,l)},m(l,o){z(e,l,o),n=!0},p(l,o){i=l;const r={};o&1&&(r.notification=i[11]),o&5&&(r.onRead=t),e.$set(r)},i(l){n||(T(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Y(e,l)}}}function Cl(i){let e,n;return e=new At({props:{notification:i[11]}}),{c(){q(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,l){z(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.notification=t[11]),e.$set(o)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function $e(i,e){let n,t,l,o,r,s=S,a;const c=[Cl,Tl],f=[];function d(m,u){return m[1]?0:1}return t=d(e),l=f[t]=c[t](e),{key:i,first:null,c(){n=I("li"),l.c(),o=V(),this.h()},l(m){n=A(m,"LI",{});var u=R(n);l.l(u),o=B(u),u.forEach(_),this.h()},h(){this.first=n},m(m,u){E(m,n,u),f[t].m(n,null),N(n,o),a=!0},p(m,u){e=m;let b=t;t=d(e),t===b?f[t].p(e,u):(W(),D(f[b],1,1,()=>{f[b]=null}),J(),l=f[t],l?l.p(e,u):(l=f[t]=c[t](e),l.c()),T(l,1),l.m(n,o))},r(){r=n.getBoundingClientRect()},f(){Ft(n),s()},a(){s(),s=Ht(n,r,El,{duration:200})},i(m){a||(T(l),a=!0)},o(m){D(l),a=!1},d(m){m&&_(n),f[t].d()}}}function xe(i){let e,n=[],t=new Map,l,o,r=Ut()+"",s,a,c,f,d,m=F(i[0]);const u=b=>b[11].id;for(let b=0;b<m.length;b+=1){let v=Xe(i,m,b),k=u(v);t.set(k,n[b]=lt(k,v))}return{c(){e=I("form");for(let b=0;b<n.length;b+=1)n[b].c();l=V(),o=I("button"),s=$(r),a=V(),c=I("span"),this.h()},l(b){e=A(b,"FORM",{method:!0,action:!0,"data-sveltekit-keepfocus":!0});var v=R(e);for(let g=0;g<n.length;g+=1)n[g].l(v);l=B(v),o=A(v,"BUTTON",{class:!0});var k=R(o);s=x(k,r),a=B(k),c=A(k,"SPAN",{class:!0}),R(c).forEach(_),k.forEach(_),v.forEach(_),this.h()},h(){p(c,"class","i-mdi-bell-check-outline"),p(o,"class","btn btn-ghost no-animation z-10 w-full rounded-none border-0 border-t border-gray-700 *:text-2xl"),p(e,"method","POST"),p(e,"action",i[5]("/notifications?/readNotifications",void 0)),p(e,"data-sveltekit-keepfocus","")},m(b,v){E(b,e,v);for(let k=0;k<n.length;k+=1)n[k]&&n[k].m(e,null);N(e,l),N(e,o),N(o,s),N(o,a),N(o,c),f||(d=se(i[4].call(null,e)),f=!0)},p(b,v){v&1&&(m=F(b[0]),n=ke(n,v,u,1,b,m,t,e,gt,lt,l,Xe))},d(b){b&&_(e);for(let v=0;v<n.length;v+=1)n[v].d();f=!1,d()}}}function et(i){let e,n=F(i[11].individualIds),t=[];for(let l=0;l<n.length;l+=1)t[l]=tt(Ke(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let o=0;o<t.length;o+=1)t[o].l(l);e=L()},m(l,o){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,o);E(l,e,o)},p(l,o){if(o&1){n=F(l[11].individualIds);let r;for(r=0;r<n.length;r+=1){const s=Ke(l,n,r);t[r]?t[r].p(s,o):(t[r]=tt(s),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},d(l){l&&_(e),ce(t,l)}}}function tt(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationIds"),e.value=n=i[14]},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[14])&&(e.value=n)},d(t){t&&_(e)}}}function lt(i,e){let n,t,l=e[11].readAt===null&&et(e);return{key:i,first:null,c(){n=L(),l&&l.c(),t=L(),this.h()},l(o){n=L(),l&&l.l(o),t=L(),this.h()},h(){this.first=n},m(o,r){E(o,n,r),l&&l.m(o,r),E(o,t,r)},p(o,r){e=o,e[11].readAt===null?l?l.p(e,r):(l=et(e),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(o){o&&(_(n),_(t)),l&&l.d(o)}}}function nt(i){let e,n=[],t=new Map,l,o,r=Vt()+"",s,a,c,f,d,m=F(i[0]);const u=b=>b[11].id;for(let b=0;b<m.length;b+=1){let v=Je(i,m,b),k=u(v);t.set(k,n[b]=ot(k,v))}return{c(){e=I("form");for(let b=0;b<n.length;b+=1)n[b].c();l=V(),o=I("button"),s=$(r),a=V(),c=I("span"),this.h()},l(b){e=A(b,"FORM",{method:!0,action:!0,"data-sveltekit-keepfocus":!0});var v=R(e);for(let g=0;g<n.length;g+=1)n[g].l(v);l=B(v),o=A(v,"BUTTON",{class:!0});var k=R(o);s=x(k,r),a=B(k),c=A(k,"SPAN",{class:!0}),R(c).forEach(_),k.forEach(_),v.forEach(_),this.h()},h(){p(c,"class","i-mdi-delete-outline"),p(o,"class","btn btn-ghost no-animation z-10 w-full rounded-none border-0 border-t border-gray-700 *:text-2xl"),p(e,"method","POST"),p(e,"action",i[5]("/notifications?/deleteNotification",void 0)),p(e,"data-sveltekit-keepfocus","")},m(b,v){E(b,e,v);for(let k=0;k<n.length;k+=1)n[k]&&n[k].m(e,null);N(e,l),N(e,o),N(o,s),N(o,a),N(o,c),f||(d=se(i[3].call(null,e)),f=!0)},p(b,v){v&1&&(m=F(b[0]),n=ke(n,v,u,1,b,m,t,e,gt,ot,l,Je))},d(b){b&&_(e);for(let v=0;v<n.length;v+=1)n[v].d();f=!1,d()}}}function it(i){let e,n;return{c(){e=I("input"),this.h()},l(t){e=A(t,"INPUT",{type:!0,name:!0}),this.h()},h(){p(e,"type","hidden"),p(e,"name","notificationIds"),e.value=n=i[14]},m(t,l){E(t,e,l)},p(t,l){l&1&&n!==(n=t[14])&&(e.value=n)},d(t){t&&_(e)}}}function ot(i,e){let n,t,l=F(e[11].individualIds),o=[];for(let r=0;r<l.length;r+=1)o[r]=it(Qe(e,l,r));return{key:i,first:null,c(){n=L();for(let r=0;r<o.length;r+=1)o[r].c();t=L(),this.h()},l(r){n=L();for(let s=0;s<o.length;s+=1)o[s].l(r);t=L(),this.h()},h(){this.first=n},m(r,s){E(r,n,s);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(r,s);E(r,t,s)},p(r,s){if(e=r,s&1){l=F(e[11].individualIds);let a;for(a=0;a<l.length;a+=1){const c=Qe(e,l,a);o[a]?o[a].p(c,s):(o[a]=it(c),o[a].c(),o[a].m(t.parentNode,t))}for(;a<o.length;a+=1)o[a].d(1);o.length=l.length}},d(r){r&&(_(n),_(t)),ce(o,r)}}}function Sl(i){let e,n,t,l;const o=[Dl,Rl],r=[];function s(a,c){return a[0].length>0?0:1}return e=s(i),n=r[e]=o[e](i),{c(){n.c(),t=L()},l(a){n.l(a),t=L()},m(a,c){r[e].m(a,c),E(a,t,c),l=!0},p(a,[c]){let f=e;e=s(a),e===f?r[e].p(a,c):(W(),D(r[f],1,1,()=>{r[f]=null}),J(),n=r[e],n?n.p(a,c):(n=r[e]=o[e](a),n.c()),T(n,1),n.m(t.parentNode,t))},i(a){l||(T(n),l=!0)},o(a){D(n),l=!1},d(a){a&&_(t),r[e].d(a)}}}const rt=i=>i.individualIds,at=i=>i.readAt===null;function Pl(i,e,n){let{form:t}=e,{notifications:l}=e,{postReveal:o=!1}=e,{onDeleted:r}=e,{onRead:s}=e;const{enhance:a}=Le(t,{onUpdate:r,id:"deleteNotification"}),{enhance:c}=Le(t,{id:"readNotifications",onSubmit:()=>{s("all")}}),f=Ne("$paraglide-adapter-sveltekit:context");function d(u,b){return typeof u!="string"||!f?u:f.translateHref(u,b)}const m=u=>s(u.id);return i.$$set=u=>{"form"in u&&n(6,t=u.form),"notifications"in u&&n(0,l=u.notifications),"postReveal"in u&&n(1,o=u.postReveal),"onDeleted"in u&&n(7,r=u.onDeleted),"onRead"in u&&n(2,s=u.onRead)},[l,o,s,a,c,d,t,r,m]}class Ml extends te{constructor(e){super(),le(this,e,Pl,Sl,ee,{form:6,notifications:0,postReveal:1,onDeleted:7,onRead:2})}}const Ll=i=>({}),st=i=>({}),Ol=i=>({unreadCount:i&1}),ct=i=>({unreadCount:i[18]});function Ul(i){const e=i.slice(),n=e[0].filter(t=>t.readAt==null).length;return e[18]=n,e}function Vl(i){let e,n,t,l={ctx:i,current:null,token:null,hasCatch:!1,pending:ql,then:Fl,catch:Hl,blocks:[,,,]};return me(n=i[1],l),{c(){e=L(),l.block.c()},l(o){e=L(),l.block.l(o)},m(o,r){E(o,e,r),l.block.m(o,l.anchor=r),l.mount=()=>e.parentNode,l.anchor=e,t=!0},p(o,r){i=o,l.ctx=i,r&2&&n!==(n=i[1])&&me(n,l)||Dt(l,i,r)},i(o){t||(T(l.block),t=!0)},o(o){for(let r=0;r<3;r+=1){const s=l.blocks[r];D(s)}t=!1},d(o){o&&_(e),l.block.d(o),l.token=null,l=null}}}function Bl(i){let e;const n=i[13].default,t=ht(n,i,i[12],ct),l=t||zl(i);return{c(){l&&l.c()},l(o){l&&l.l(o)},m(o,r){l&&l.m(o,r),e=!0},p(o,r){t?t.p&&(!e||r&4097)&&mt(t,n,o,o[12],e?bt(n,o[12],r,Ol):pt(o[12]),ct):l&&l.p&&(!e||r&1)&&l.p(o,e?r:-1)},i(o){e||(T(l,o),e=!0)},o(o){D(l,o),e=!1},d(o){l&&l.d(o)}}}function Hl(i){return{c:S,l:S,m:S,p:S,i:S,o:S,d:S}}function Fl(i){return{c:S,l:S,m:S,p:S,i:S,o:S,d:S}}function ql(i){let e;const n=i[13].loading,t=ht(n,i,i[12],st),l=t||jl();return{c(){l&&l.c()},l(o){l&&l.l(o)},m(o,r){l&&l.m(o,r),e=!0},p(o,r){t&&t.p&&(!e||r&4096)&&mt(t,n,o,o[12],e?bt(n,o[12],r,Ll):pt(o[12]),st)},i(o){e||(T(l,o),e=!0)},o(o){D(l,o),e=!1},d(o){l&&l.d(o)}}}function jl(i){let e;return{c(){e=I("span"),this.h()},l(n){e=A(n,"SPAN",{class:!0}),R(e).forEach(_),this.h()},h(){p(e,"class","i-mdi-bell-outline mx-auto")},m(n,t){E(n,e,t)},p:S,d(n){n&&_(e)}}}function ft(i){let e;return{c(){e=I("span"),this.h()},l(n){e=A(n,"SPAN",{class:!0}),R(e).forEach(_),this.h()},h(){p(e,"class","i-mdi-bell-outline")},m(n,t){E(n,e,t)},d(n){n&&_(e)}}}function ut(i){let e,n,t,l=i[18]+"",o;return{c(){e=I("span"),n=V(),t=I("span"),o=$(l),this.h()},l(r){e=A(r,"SPAN",{class:!0}),R(e).forEach(_),n=B(r),t=A(r,"SPAN",{class:!0});var s=R(t);o=x(s,l),s.forEach(_),this.h()},h(){p(e,"class","i-mdi-bell-ring-outline animate-bounce"),p(t,"class","absolute right-0 top-0 flex h-6 w-6 items-center justify-center rounded-box bg-red-600 text-center !text-sm")},m(r,s){E(r,e,s),E(r,n,s),E(r,t,s),N(t,o)},p(r,s){s&1&&l!==(l=r[18]+"")&&re(o,l)},d(r){r&&(_(e),_(n),_(t))}}}function zl(i){let e,n,t=i[18]<=0&&ft(),l=i[18]>0&&ut(i);return{c(){t&&t.c(),e=V(),l&&l.c(),n=L()},l(o){t&&t.l(o),e=B(o),l&&l.l(o),n=L()},m(o,r){t&&t.m(o,r),E(o,e,r),l&&l.m(o,r),E(o,n,r)},p(o,r){o[18]<=0?t||(t=ft(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null),o[18]>0?l?l.p(o,r):(l=ut(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&(_(e),_(n)),t&&t.d(o),l&&l.d(o)}}}function Yl(i){let e,n,t,l;const o=[Jl,Wl],r=[];function s(a,c){return a[0]!==void 0?0:1}return n=s(i),t=r[n]=o[n](i),{c(){e=I("ul"),t.c(),this.h()},l(a){e=A(a,"UL",{tabindex:!0,class:!0});var c=R(e);t.l(c),c.forEach(_),this.h()},h(){p(e,"tabindex","0"),p(e,"class","menu dropdown-content !fixed right-0 z-[1] max-h-[80svh] w-full flex-nowrap overflow-clip rounded-box bg-base-100 p-0 shadow sm:!absolute sm:w-[27rem]")},m(a,c){E(a,e,c),r[n].m(e,null),l=!0},p(a,c){let f=n;n=s(a),n===f?r[n].p(a,c):(W(),D(r[f],1,1,()=>{r[f]=null}),J(),t=r[n],t?t.p(a,c):(t=r[n]=o[n](a),t.c()),T(t,1),t.m(e,null))},i(a){l||(T(t),l=!0)},o(a){D(t),l=!1},d(a){a&&_(e),r[n].d()}}}function Gl(i){let e,n,t,l;function o(a){i[16](a)}function r(a){i[17](a)}let s={postReveal:i[6],onRead:i[7]};return i[8]!==void 0&&(s.modal=i[8]),i[0]!==void 0&&(s.notifications=i[0]),e=new Nl({props:s}),ae.push(()=>Se(e,"modal",o)),ae.push(()=>Se(e,"notifications",r)),{c(){q(e.$$.fragment)},l(a){j(e.$$.fragment,a)},m(a,c){z(e,a,c),l=!0},p(a,c){const f={};c&64&&(f.postReveal=a[6]),c&128&&(f.onRead=a[7]),!n&&c&256&&(n=!0,f.modal=a[8],Ce(()=>n=!1)),!t&&c&1&&(t=!0,f.notifications=a[0],Ce(()=>t=!1)),e.$set(f)},i(a){l||(T(e.$$.fragment,a),l=!0)},o(a){D(e.$$.fragment,a),l=!1},d(a){Y(e,a)}}}function Wl(i){let e,n,t={ctx:i,current:null,token:null,hasCatch:!1,pending:Kl,then:Xl,catch:Ql};return me(n=i[1],t),{c(){e=L(),t.block.c()},l(l){e=L(),t.block.l(l)},m(l,o){E(l,e,o),t.block.m(l,t.anchor=o),t.mount=()=>e.parentNode,t.anchor=e},p(l,o){i=l,t.ctx=i,o&2&&n!==(n=i[1])&&me(n,t)},i:S,o:S,d(l){l&&_(e),t.block.d(l),t.token=null,t=null}}}function Jl(i){let e,n;return e=new Ml({props:{notifications:i[0],postReveal:i[6],onDeleted:i[10],form:i[2],onRead:i[7]}}),{c(){q(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,l){z(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.notifications=t[0]),l&64&&(o.postReveal=t[6]),l&4&&(o.form=t[2]),l&128&&(o.onRead=t[7]),e.$set(o)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ql(i){return{c:S,l:S,m:S,d:S}}function Xl(i){return{c:S,l:S,m:S,d:S}}function Kl(i){let e;return{c(){e=I("span"),this.h()},l(n){e=A(n,"SPAN",{class:!0}),R(e).forEach(_),this.h()},h(){p(e,"class","loading loading-lg")},m(n,t){E(n,e,t)},d(n){n&&_(e)}}}function Zl(i){let e,n,t,l,o,r,s,a,c,f,d;const m=[Bl,Vl],u=[];function b(w,C){return w[0]!==void 0?0:1}function v(w,C){return C===0?Ul(w):w}t=b(i),l=u[t]=m[t](v(i,t));const k=[Gl,Yl],g=[];function h(w,C){return!w[4]&&w[3]?0:w[4]?-1:1}return~(s=h(i))&&(a=g[s]=k[s](i)),{c(){e=I("div"),n=I("button"),l.c(),r=V(),a&&a.c(),this.h()},l(w){e=A(w,"DIV",{class:!0});var C=R(e);n=A(C,"BUTTON",{type:!0,tabindex:!0,class:!0,"data-dropdown-toggle":!0});var y=R(n);l.l(y),y.forEach(_),r=B(C),a&&a.l(C),C.forEach(_),this.h()},h(){p(n,"type","button"),p(n,"tabindex","0"),p(n,"class",o=Me("btn btn-ghost *:text-xl",i[5])),p(n,"data-dropdown-toggle","dropdown"),p(e,"class","dropdown")},m(w,C){E(w,e,C),N(e,n),u[t].m(n,null),i[14](n),N(e,r),~s&&g[s].m(e,null),c=!0,f||(d=Ae(n,"click",function(){pe(i[4]||i[3]?i[15]:void 0)&&(i[4]||i[3]?i[15]:void 0).apply(this,arguments)}),f=!0)},p(w,[C]){i=w;let y=t;t=b(i),t===y?u[t].p(v(i,t),C):(W(),D(u[y],1,1,()=>{u[y]=null}),J(),l=u[t],l?l.p(v(i,t),C):(l=u[t]=m[t](v(i,t)),l.c()),T(l,1),l.m(n,null)),(!c||C&32&&o!==(o=Me("btn btn-ghost *:text-xl",i[5])))&&p(n,"class",o);let P=s;s=h(i),s===P?~s&&g[s].p(i,C):(a&&(W(),D(g[P],1,1,()=>{g[P]=null}),J()),~s?(a=g[s],a?a.p(i,C):(a=g[s]=k[s](i),a.c()),T(a,1),a.m(e,null)):a=null)},i(w){c||(T(l),T(a),c=!0)},o(w){D(l),D(a),c=!1},d(w){w&&_(e),u[t].d(),i[14](null),~s&&g[s].d(),f=!1,d()}}}function $l(i,e,n){let t;be(i,ge,y=>n(11,t=y));let{$$slots:l={},$$scope:o}=e,{notificationsPromise:r}=e,{form:s}=e,{useModalInstead:a=!1}=e,{externalModal:c=void 0}=e,{buttonClass:f=void 0}=e,{postReveal:d=!1}=e,{notifications:m=void 0}=e,u,b;const v=()=>{b.focus()};let{onRead:k=y=>{y==="all"?n(0,m=m==null?void 0:m.map(P=>({...P,readAt:new Date}))):n(0,m=m==null?void 0:m.map(P=>P.id===y?{...P,readAt:new Date}:P))}}=e;function g(y){ae[y?"unshift":"push"](()=>{b=y,n(9,b)})}const h=()=>(c??u).showModal();function w(y){u=y,n(8,u)}function C(y){m=y,n(0,m),n(1,r)}return i.$$set=y=>{"notificationsPromise"in y&&n(1,r=y.notificationsPromise),"form"in y&&n(2,s=y.form),"useModalInstead"in y&&n(3,a=y.useModalInstead),"externalModal"in y&&n(4,c=y.externalModal),"buttonClass"in y&&n(5,f=y.buttonClass),"postReveal"in y&&n(6,d=y.postReveal),"notifications"in y&&n(0,m=y.notifications),"onRead"in y&&n(7,k=y.onRead),"$$scope"in y&&n(12,o=y.$$scope)},i.$$.update=()=>{i.$$.dirty&2&&r.then(y=>{n(0,m=y)}),i.$$.dirty&2048&&(()=>{var y,P,X;((X=(P=(y=t.form)==null?void 0:y.form)==null?void 0:P.data)==null?void 0:X.notificationId)!==void 0&&setTimeout(()=>{v()})})()},[m,r,s,a,c,f,d,k,u,b,v,t,o,l,g,h,w,C]}class kn extends te{constructor(e){super(),le(this,e,$l,Zl,ee,{notificationsPromise:1,form:2,useModalInstead:3,externalModal:4,buttonClass:5,postReveal:6,notifications:0,onRead:7})}}function xl(i,e,n){let{notificationCount:t=void 0}=e;const l=async o=>{o!==void 0&&(window.unreadNotificationCount=o,window.dispatchEvent(new CustomEvent("unreadNotificationCount",{detail:{count:o}})))};return i.$$set=o=>{"notificationCount"in o&&n(0,t=o.notificationCount)},i.$$.update=()=>{i.$$.dirty&1&&l(t)},[t]}class vn extends te{constructor(e){super(),le(this,e,xl,null,ee,{notificationCount:0})}}function en(i,e,n){let t,l;be(i,ge,a=>n(2,l=a));const o=async a=>{try{const c=await fetch("/api/notifications/uploadToken",{method:"POST",body:JSON.stringify({notificationToken:a})});c.ok||ye(`Failed to upload notification token. ${(await c.json()).message??""}`,"error")}catch(c){c instanceof Error&&ye(c.message,"error"),ye(`${c}`,"error")}};let r,s=null;return _t(()=>{r=window.addEventListener("appSendNotificationToken",c=>{var d;const f=(d=c.detail)==null?void 0:d.token;f&&n(0,s=f)});const a=window.notificationToken;a&&n(0,s=a)}),Rt(()=>{r&&window.removeEventListener("appSendNotificationToken",r)}),i.$$.update=()=>{var a;i.$$.dirty&4&&n(1,t=!!((a=l.data.user)!=null&&a.memberId)),i.$$.dirty&3&&t&&s&&o(s)},[s,t,l]}class wn extends te{constructor(e){super(),le(this,e,en,null,ee,{})}}export{wn as A,Nl as N,kn as a,vn as b};
